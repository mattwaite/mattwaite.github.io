<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 41 Using packages to get data | Sports Data Analysis and Visualization</title>
  <meta name="description" content="The companion book to the University of Nebraska-Lincoln’s SPMC350 course in the College of Journalism and Mass Communications." />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 41 Using packages to get data | Sports Data Analysis and Visualization" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="http://mattwaite.github.io/sports/" />
  
  <meta property="og:description" content="The companion book to the University of Nebraska-Lincoln’s SPMC350 course in the College of Journalism and Mass Communications." />
  <meta name="github-repo" content="mattwaite/sportsdatabook" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 41 Using packages to get data | Sports Data Analysis and Visualization" />
  
  <meta name="twitter:description" content="The companion book to the University of Nebraska-Lincoln’s SPMC350 course in the College of Journalism and Mass Communications." />
  

<meta name="author" content="Matt Waite" />


<meta name="date" content="2021-11-28" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="images/favicon.ico" type="image/x-icon" />
<link rel="prev" href="project-checklist.html"/>
<link rel="next" href="appendix.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.9.4.1/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.1/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.57.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.57.1/plotly-latest.min.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-160712129-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-160712129-1');
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Sports Data Analysis and Visualization</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Throwing cold water on hot takes</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#requirements-and-conventions"><i class="fa fa-check"></i><b>1.1</b> Requirements and Conventions</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#about-this-book"><i class="fa fa-check"></i><b>1.2</b> About this book</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="the-very-basics.html"><a href="the-very-basics.html"><i class="fa fa-check"></i><b>2</b> The very basics</a>
<ul>
<li class="chapter" data-level="2.1" data-path="the-very-basics.html"><a href="the-very-basics.html#adding-libraries-part-1"><i class="fa fa-check"></i><b>2.1</b> Adding libraries, part 1</a></li>
<li class="chapter" data-level="2.2" data-path="the-very-basics.html"><a href="the-very-basics.html#adding-libraries-part-2"><i class="fa fa-check"></i><b>2.2</b> Adding libraries, part 2</a></li>
<li class="chapter" data-level="2.3" data-path="the-very-basics.html"><a href="the-very-basics.html#notebooks"><i class="fa fa-check"></i><b>2.3</b> Notebooks</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data-structures-and-types.html"><a href="data-structures-and-types.html"><i class="fa fa-check"></i><b>3</b> Data, structures and types</a>
<ul>
<li class="chapter" data-level="3.1" data-path="data-structures-and-types.html"><a href="data-structures-and-types.html#rows-and-columns"><i class="fa fa-check"></i><b>3.1</b> Rows and columns</a></li>
<li class="chapter" data-level="3.2" data-path="data-structures-and-types.html"><a href="data-structures-and-types.html#types"><i class="fa fa-check"></i><b>3.2</b> Types</a></li>
<li class="chapter" data-level="3.3" data-path="data-structures-and-types.html"><a href="data-structures-and-types.html#a-simple-way-to-get-data"><i class="fa fa-check"></i><b>3.3</b> A simple way to get data</a></li>
<li class="chapter" data-level="3.4" data-path="data-structures-and-types.html"><a href="data-structures-and-types.html#cleaning-the-data"><i class="fa fa-check"></i><b>3.4</b> Cleaning the data</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="aggregates.html"><a href="aggregates.html"><i class="fa fa-check"></i><b>4</b> Aggregates</a>
<ul>
<li class="chapter" data-level="4.1" data-path="aggregates.html"><a href="aggregates.html#basic-data-analysis-group-by-and-count"><i class="fa fa-check"></i><b>4.1</b> Basic data analysis: Group By and Count</a></li>
<li class="chapter" data-level="4.2" data-path="aggregates.html"><a href="aggregates.html#other-aggregates-mean-and-median"><i class="fa fa-check"></i><b>4.2</b> Other aggregates: Mean and median</a></li>
<li class="chapter" data-level="4.3" data-path="aggregates.html"><a href="aggregates.html#even-more-aggregates"><i class="fa fa-check"></i><b>4.3</b> Even more aggregates</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="mutating-data.html"><a href="mutating-data.html"><i class="fa fa-check"></i><b>5</b> Mutating data</a>
<ul>
<li class="chapter" data-level="5.1" data-path="mutating-data.html"><a href="mutating-data.html#a-more-complex-example"><i class="fa fa-check"></i><b>5.1</b> A more complex example</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="filters-and-selections.html"><a href="filters-and-selections.html"><i class="fa fa-check"></i><b>6</b> Filters and selections</a>
<ul>
<li class="chapter" data-level="6.1" data-path="filters-and-selections.html"><a href="filters-and-selections.html#selecting-data-to-make-it-easier-to-read"><i class="fa fa-check"></i><b>6.1</b> Selecting data to make it easier to read</a></li>
<li class="chapter" data-level="6.2" data-path="filters-and-selections.html"><a href="filters-and-selections.html#using-conditional-filters-to-set-limits"><i class="fa fa-check"></i><b>6.2</b> Using conditional filters to set limits</a></li>
<li class="chapter" data-level="6.3" data-path="filters-and-selections.html"><a href="filters-and-selections.html#top-list"><i class="fa fa-check"></i><b>6.3</b> Top list</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="transforming-data.html"><a href="transforming-data.html"><i class="fa fa-check"></i><b>7</b> Transforming data</a>
<ul>
<li class="chapter" data-level="7.1" data-path="transforming-data.html"><a href="transforming-data.html#making-long-data-wide"><i class="fa fa-check"></i><b>7.1</b> Making long data wide</a></li>
<li class="chapter" data-level="7.2" data-path="transforming-data.html"><a href="transforming-data.html#why-this-matters"><i class="fa fa-check"></i><b>7.2</b> Why this matters</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="significance-tests.html"><a href="significance-tests.html"><i class="fa fa-check"></i><b>8</b> Significance tests</a>
<ul>
<li class="chapter" data-level="8.1" data-path="significance-tests.html"><a href="significance-tests.html#accepting-the-null-hypothesis"><i class="fa fa-check"></i><b>8.1</b> Accepting the null hypothesis</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="correlations-and-regression.html"><a href="correlations-and-regression.html"><i class="fa fa-check"></i><b>9</b> Correlations and regression</a>
<ul>
<li class="chapter" data-level="9.1" data-path="correlations-and-regression.html"><a href="correlations-and-regression.html#a-more-predictive-example"><i class="fa fa-check"></i><b>9.1</b> A more predictive example</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="multiple-regression.html"><a href="multiple-regression.html"><i class="fa fa-check"></i><b>10</b> Multiple regression</a></li>
<li class="chapter" data-level="11" data-path="residuals.html"><a href="residuals.html"><i class="fa fa-check"></i><b>11</b> Residuals</a>
<ul>
<li class="chapter" data-level="11.1" data-path="residuals.html"><a href="residuals.html#penalties"><i class="fa fa-check"></i><b>11.1</b> Penalties</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="z-scores.html"><a href="z-scores.html"><i class="fa fa-check"></i><b>12</b> Z-scores</a>
<ul>
<li class="chapter" data-level="12.1" data-path="z-scores.html"><a href="z-scores.html#calculating-a-z-score-in-r"><i class="fa fa-check"></i><b>12.1</b> Calculating a Z score in R</a></li>
<li class="chapter" data-level="12.2" data-path="z-scores.html"><a href="z-scores.html#writing-about-z-scores"><i class="fa fa-check"></i><b>12.2</b> Writing about z-scores</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="clustering.html"><a href="clustering.html"><i class="fa fa-check"></i><b>13</b> Clustering</a>
<ul>
<li class="chapter" data-level="13.1" data-path="clustering.html"><a href="clustering.html#advanced-metrics"><i class="fa fa-check"></i><b>13.1</b> Advanced metrics</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="simulations.html"><a href="simulations.html"><i class="fa fa-check"></i><b>14</b> Simulations</a>
<ul>
<li class="chapter" data-level="14.1" data-path="simulations.html"><a href="simulations.html#cold-streaks"><i class="fa fa-check"></i><b>14.1</b> Cold streaks</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="intro-to-ggplot.html"><a href="intro-to-ggplot.html"><i class="fa fa-check"></i><b>15</b> Intro to ggplot</a>
<ul>
<li class="chapter" data-level="15.1" data-path="intro-to-ggplot.html"><a href="intro-to-ggplot.html#the-bar-chart"><i class="fa fa-check"></i><b>15.1</b> The bar chart</a></li>
<li class="chapter" data-level="15.2" data-path="intro-to-ggplot.html"><a href="intro-to-ggplot.html#scales"><i class="fa fa-check"></i><b>15.2</b> Scales</a></li>
<li class="chapter" data-level="15.3" data-path="intro-to-ggplot.html"><a href="intro-to-ggplot.html#styling"><i class="fa fa-check"></i><b>15.3</b> Styling</a></li>
<li class="chapter" data-level="15.4" data-path="intro-to-ggplot.html"><a href="intro-to-ggplot.html#one-last-trick-coord-flip"><i class="fa fa-check"></i><b>15.4</b> One last trick: coord flip</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="stacked-bar-charts.html"><a href="stacked-bar-charts.html"><i class="fa fa-check"></i><b>16</b> Stacked bar charts</a></li>
<li class="chapter" data-level="17" data-path="circular-bar-plots.html"><a href="circular-bar-plots.html"><i class="fa fa-check"></i><b>17</b> Circular bar plots</a>
<ul>
<li class="chapter" data-level="17.1" data-path="circular-bar-plots.html"><a href="circular-bar-plots.html#does-november-basketball-matter"><i class="fa fa-check"></i><b>17.1</b> Does November basketball matter?</a></li>
<li class="chapter" data-level="17.2" data-path="circular-bar-plots.html"><a href="circular-bar-plots.html#does-it-show-you-where-you-are"><i class="fa fa-check"></i><b>17.2</b> Does it show you where you are?</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="waffle-charts.html"><a href="waffle-charts.html"><i class="fa fa-check"></i><b>18</b> Waffle charts</a>
<ul>
<li class="chapter" data-level="18.1" data-path="waffle-charts.html"><a href="waffle-charts.html#making-waffles-with-vectors"><i class="fa fa-check"></i><b>18.1</b> Making waffles with vectors</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="line-charts.html"><a href="line-charts.html"><i class="fa fa-check"></i><b>19</b> Line charts</a>
<ul>
<li class="chapter" data-level="19.1" data-path="line-charts.html"><a href="line-charts.html#this-is-too-simple."><i class="fa fa-check"></i><b>19.1</b> This is too simple.</a></li>
<li class="chapter" data-level="19.2" data-path="line-charts.html"><a href="line-charts.html#but-what-if-i-wanted-to-add-a-lot-of-lines."><i class="fa fa-check"></i><b>19.2</b> But what if I wanted to add a lot of lines.</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="step-charts.html"><a href="step-charts.html"><i class="fa fa-check"></i><b>20</b> Step charts</a></li>
<li class="chapter" data-level="21" data-path="ridge-charts.html"><a href="ridge-charts.html"><i class="fa fa-check"></i><b>21</b> Ridge charts</a></li>
<li class="chapter" data-level="22" data-path="dumbbell-and-lollipop-charts.html"><a href="dumbbell-and-lollipop-charts.html"><i class="fa fa-check"></i><b>22</b> Dumbbell and lollipop charts</a>
<ul>
<li class="chapter" data-level="22.1" data-path="dumbbell-and-lollipop-charts.html"><a href="dumbbell-and-lollipop-charts.html#dumbbell-plots"><i class="fa fa-check"></i><b>22.1</b> Dumbbell plots</a></li>
<li class="chapter" data-level="22.2" data-path="dumbbell-and-lollipop-charts.html"><a href="dumbbell-and-lollipop-charts.html#lollipop-charts"><i class="fa fa-check"></i><b>22.2</b> Lollipop charts</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="scatterplots.html"><a href="scatterplots.html"><i class="fa fa-check"></i><b>23</b> Scatterplots</a>
<ul>
<li class="chapter" data-level="23.1" data-path="scatterplots.html"><a href="scatterplots.html#lets-see-it-work"><i class="fa fa-check"></i><b>23.1</b> Let’s see it work</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="bubble-charts.html"><a href="bubble-charts.html"><i class="fa fa-check"></i><b>24</b> Bubble charts</a></li>
<li class="chapter" data-level="25" data-path="beeswarm-plots.html"><a href="beeswarm-plots.html"><i class="fa fa-check"></i><b>25</b> Beeswarm plots</a>
<ul>
<li class="chapter" data-level="25.1" data-path="beeswarm-plots.html"><a href="beeswarm-plots.html#a-few-other-options"><i class="fa fa-check"></i><b>25.1</b> A few other options</a></li>
</ul></li>
<li class="chapter" data-level="26" data-path="bump-charts.html"><a href="bump-charts.html"><i class="fa fa-check"></i><b>26</b> Bump charts</a></li>
<li class="chapter" data-level="27" data-path="tables.html"><a href="tables.html"><i class="fa fa-check"></i><b>27</b> Tables</a></li>
<li class="chapter" data-level="28" data-path="facet-wraps.html"><a href="facet-wraps.html"><i class="fa fa-check"></i><b>28</b> Facet wraps</a>
<ul>
<li class="chapter" data-level="28.1" data-path="facet-wraps.html"><a href="facet-wraps.html#facet-grid-vs-facet-wraps"><i class="fa fa-check"></i><b>28.1</b> Facet grid vs facet wraps</a></li>
<li class="chapter" data-level="28.2" data-path="facet-wraps.html"><a href="facet-wraps.html#other-types"><i class="fa fa-check"></i><b>28.2</b> Other types</a></li>
</ul></li>
<li class="chapter" data-level="29" data-path="arranging-multiple-plots-together.html"><a href="arranging-multiple-plots-together.html"><i class="fa fa-check"></i><b>29</b> Arranging multiple plots together</a></li>
<li class="chapter" data-level="30" data-path="encircling-points-on-a-scatterplot.html"><a href="encircling-points-on-a-scatterplot.html"><i class="fa fa-check"></i><b>30</b> Encircling points on a scatterplot</a>
<ul>
<li class="chapter" data-level="30.1" data-path="encircling-points-on-a-scatterplot.html"><a href="encircling-points-on-a-scatterplot.html#a-different-more-local-example"><i class="fa fa-check"></i><b>30.1</b> A different, more local example</a></li>
</ul></li>
<li class="chapter" data-level="31" data-path="plotly.html"><a href="plotly.html"><i class="fa fa-check"></i><b>31</b> Plotly</a>
<ul>
<li class="chapter" data-level="31.1" data-path="plotly.html"><a href="plotly.html#publishing-using-plotly"><i class="fa fa-check"></i><b>31.1</b> Publishing using Plotly</a></li>
</ul></li>
<li class="chapter" data-level="32" data-path="text-cleaning.html"><a href="text-cleaning.html"><i class="fa fa-check"></i><b>32</b> Text cleaning</a>
<ul>
<li class="chapter" data-level="32.1" data-path="text-cleaning.html"><a href="text-cleaning.html#stripping-out-text"><i class="fa fa-check"></i><b>32.1</b> Stripping out text</a></li>
<li class="chapter" data-level="32.2" data-path="text-cleaning.html"><a href="text-cleaning.html#another-example-splitting-columns"><i class="fa fa-check"></i><b>32.2</b> Another example: splitting columns</a></li>
</ul></li>
<li class="chapter" data-level="33" data-path="headlines.html"><a href="headlines.html"><i class="fa fa-check"></i><b>33</b> Headlines</a></li>
<li class="chapter" data-level="34" data-path="annotations.html"><a href="annotations.html"><i class="fa fa-check"></i><b>34</b> Annotations</a></li>
<li class="chapter" data-level="35" data-path="finishing-touches.html"><a href="finishing-touches.html"><i class="fa fa-check"></i><b>35</b> Finishing touches</a>
<ul>
<li class="chapter" data-level="35.1" data-path="finishing-touches.html"><a href="finishing-touches.html#graphics-vs-visual-stories"><i class="fa fa-check"></i><b>35.1</b> Graphics vs visual stories</a></li>
<li class="chapter" data-level="35.2" data-path="finishing-touches.html"><a href="finishing-touches.html#getting-ggplot-closer-to-output"><i class="fa fa-check"></i><b>35.2</b> Getting ggplot closer to output</a></li>
<li class="chapter" data-level="35.3" data-path="finishing-touches.html"><a href="finishing-touches.html#waffle-charts-require-special-attention"><i class="fa fa-check"></i><b>35.3</b> Waffle charts require special attention</a></li>
<li class="chapter" data-level="35.4" data-path="finishing-touches.html"><a href="finishing-touches.html#advanced-text-wrangling"><i class="fa fa-check"></i><b>35.4</b> Advanced text wrangling</a></li>
</ul></li>
<li class="chapter" data-level="36" data-path="rtweet-and-text-analysis.html"><a href="rtweet-and-text-analysis.html"><i class="fa fa-check"></i><b>36</b> Rtweet and Text Analysis</a>
<ul>
<li class="chapter" data-level="36.1" data-path="rtweet-and-text-analysis.html"><a href="rtweet-and-text-analysis.html#prerequisites"><i class="fa fa-check"></i><b>36.1</b> Prerequisites</a>
<ul>
<li class="chapter" data-level="36.1.1" data-path="rtweet-and-text-analysis.html"><a href="rtweet-and-text-analysis.html#tools-for-text-analysis"><i class="fa fa-check"></i><b>36.1.1</b> Tools for text analysis</a></li>
<li class="chapter" data-level="36.1.2" data-path="rtweet-and-text-analysis.html"><a href="rtweet-and-text-analysis.html#working-with-string-data"><i class="fa fa-check"></i><b>36.1.2</b> Working with string data</a></li>
</ul></li>
<li class="chapter" data-level="36.2" data-path="rtweet-and-text-analysis.html"><a href="rtweet-and-text-analysis.html#verifying-your-account-to-access-twitter-data"><i class="fa fa-check"></i><b>36.2</b> Verifying your account to access Twitter data</a></li>
<li class="chapter" data-level="36.3" data-path="rtweet-and-text-analysis.html"><a href="rtweet-and-text-analysis.html#the-data-used-here"><i class="fa fa-check"></i><b>36.3</b> The data used here</a></li>
<li class="chapter" data-level="36.4" data-path="rtweet-and-text-analysis.html"><a href="rtweet-and-text-analysis.html#data-exploration"><i class="fa fa-check"></i><b>36.4</b> Data Exploration</a></li>
<li class="chapter" data-level="36.5" data-path="rtweet-and-text-analysis.html"><a href="rtweet-and-text-analysis.html#cleaning-data-for-analysis"><i class="fa fa-check"></i><b>36.5</b> Cleaning data for analysis</a>
<ul>
<li class="chapter" data-level="36.5.1" data-path="rtweet-and-text-analysis.html"><a href="rtweet-and-text-analysis.html#fixing-the-date-and-focusing-only-on-game-tweets"><i class="fa fa-check"></i><b>36.5.1</b> Fixing the date and focusing only on game tweets</a></li>
</ul></li>
<li class="chapter" data-level="36.6" data-path="rtweet-and-text-analysis.html"><a href="rtweet-and-text-analysis.html#number-of-tweets-throughout-the-game"><i class="fa fa-check"></i><b>36.6</b> Number of tweets throughout the game</a></li>
<li class="chapter" data-level="36.7" data-path="rtweet-and-text-analysis.html"><a href="rtweet-and-text-analysis.html#tidying-the-text-data-for-analysis-applying-the-sentiment-scores"><i class="fa fa-check"></i><b>36.7</b> Tidying the text data for analysis, applying the sentiment scores</a>
<ul>
<li class="chapter" data-level="36.7.1" data-path="rtweet-and-text-analysis.html"><a href="rtweet-and-text-analysis.html#example-2---nebraskas-loss-to-purdue-what-were-fans-sentiments-towards-this-loss"><i class="fa fa-check"></i><b>36.7.1</b> Example 2 - Nebraska’s loss to Purdue, what were fan’s sentiments towards this loss?</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="37" data-path="intro-to-rvest.html"><a href="intro-to-rvest.html"><i class="fa fa-check"></i><b>37</b> Intro to rvest</a>
<ul>
<li class="chapter" data-level="37.1" data-path="intro-to-rvest.html"><a href="intro-to-rvest.html#a-slightly-more-complicated-example"><i class="fa fa-check"></i><b>37.1</b> A slightly more complicated example</a></li>
<li class="chapter" data-level="37.2" data-path="intro-to-rvest.html"><a href="intro-to-rvest.html#an-even-more-complicated-example"><i class="fa fa-check"></i><b>37.2</b> An even more complicated example</a></li>
</ul></li>
<li class="chapter" data-level="38" data-path="advanced-rvest.html"><a href="advanced-rvest.html"><i class="fa fa-check"></i><b>38</b> Advanced rvest</a>
<ul>
<li class="chapter" data-level="38.1" data-path="advanced-rvest.html"><a href="advanced-rvest.html#one-last-bit"><i class="fa fa-check"></i><b>38.1</b> One last bit</a></li>
</ul></li>
<li class="chapter" data-level="39" data-path="building-your-own-blog-with-blogdown.html"><a href="building-your-own-blog-with-blogdown.html"><i class="fa fa-check"></i><b>39</b> Building your own blog with blogdown</a>
<ul>
<li class="chapter" data-level="39.1" data-path="building-your-own-blog-with-blogdown.html"><a href="building-your-own-blog-with-blogdown.html#setup"><i class="fa fa-check"></i><b>39.1</b> Setup</a></li>
<li class="chapter" data-level="39.2" data-path="building-your-own-blog-with-blogdown.html"><a href="building-your-own-blog-with-blogdown.html#seeing-your-site"><i class="fa fa-check"></i><b>39.2</b> Seeing your site</a></li>
<li class="chapter" data-level="39.3" data-path="building-your-own-blog-with-blogdown.html"><a href="building-your-own-blog-with-blogdown.html#editing-existing-markdown-content"><i class="fa fa-check"></i><b>39.3</b> Editing existing Markdown content</a></li>
<li class="chapter" data-level="39.4" data-path="building-your-own-blog-with-blogdown.html"><a href="building-your-own-blog-with-blogdown.html#creating-a-new-post-in-r-markdown"><i class="fa fa-check"></i><b>39.4</b> Creating a new post in R Markdown</a></li>
<li class="chapter" data-level="39.5" data-path="building-your-own-blog-with-blogdown.html"><a href="building-your-own-blog-with-blogdown.html#publishing-your-site"><i class="fa fa-check"></i><b>39.5</b> Publishing your site</a></li>
</ul></li>
<li class="chapter" data-level="40" data-path="project-checklist.html"><a href="project-checklist.html"><i class="fa fa-check"></i><b>40</b> Project Checklist</a>
<ul>
<li class="chapter" data-level="40.1" data-path="project-checklist.html"><a href="project-checklist.html#writing-checklist"><i class="fa fa-check"></i><b>40.1</b> Writing checklist</a></li>
<li class="chapter" data-level="40.2" data-path="project-checklist.html"><a href="project-checklist.html#headline-checklist"><i class="fa fa-check"></i><b>40.2</b> Headline checklist</a></li>
<li class="chapter" data-level="40.3" data-path="project-checklist.html"><a href="project-checklist.html#graphics-checklist"><i class="fa fa-check"></i><b>40.3</b> Graphics checklist</a></li>
<li class="chapter" data-level="40.4" data-path="project-checklist.html"><a href="project-checklist.html#code-checklist"><i class="fa fa-check"></i><b>40.4</b> Code checklist</a></li>
<li class="chapter" data-level="40.5" data-path="project-checklist.html"><a href="project-checklist.html#last-thing"><i class="fa fa-check"></i><b>40.5</b> Last thing</a></li>
</ul></li>
<li class="chapter" data-level="41" data-path="using-packages-to-get-data.html"><a href="using-packages-to-get-data.html"><i class="fa fa-check"></i><b>41</b> Using packages to get data</a>
<ul>
<li class="chapter" data-level="41.1" data-path="using-packages-to-get-data.html"><a href="using-packages-to-get-data.html#using-cfbfastr-as-a-cautionary-tale"><i class="fa fa-check"></i><b>41.1</b> Using cfbfastR as a cautionary tale</a></li>
<li class="chapter" data-level="41.2" data-path="using-packages-to-get-data.html"><a href="using-packages-to-get-data.html#another-example"><i class="fa fa-check"></i><b>41.2</b> Another example</a></li>
<li class="chapter" data-level="41.3" data-path="using-packages-to-get-data.html"><a href="using-packages-to-get-data.html#one-more-futbol-is-life"><i class="fa fa-check"></i><b>41.3</b> One more: Futbol is life</a></li>
</ul></li>
<li class="chapter" data-level="42" data-path="appendix.html"><a href="appendix.html"><i class="fa fa-check"></i><b>42</b> Appendix</a>
<ul>
<li class="chapter" data-level="42.1" data-path="appendix.html"><a href="appendix.html#how-to-get-help-in-this-class"><i class="fa fa-check"></i><b>42.1</b> How to get help in this class</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Sports Data Analysis and Visualization</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="using-packages-to-get-data" class="section level1" number="41">
<h1><span class="header-section-number">Chapter 41</span> Using packages to get data</h1>
<p>There is a growing number of packages and repositories of sports data, largely because there’s a growing number of people who want to analyze that data. We’ve <a href="http://mattwaite.github.io/sports/data-structures-and-types.html#a-simple-way-to-get-data">done it ourselves with simple Google Sheets tricks</a>. Then there’s <a href="http://mattwaite.github.io/sports/intro-to-rvest.html">RVest, which is a method of scraping the data yourself from websites</a>. But with these packages, someone has done the work of gathering the data for you. All you have to learn are the commands to get it.</p>
<p>One very promising collection of libraries is something called the <a href="https://sportsdataverse.org/">SportsDataverse</a>, which has a collection of packages covering specific sports, all of which are in various stages of development. Some are more complete than others, but they are all being actively worked on by developers. Packages of interest in this class are:</p>
<ul>
<li><a href="https://saiemgilani.github.io/cfbfastR/">cfbfastR, for college football</a>.</li>
<li><a href="https://saiemgilani.github.io/hoopR/">hoopR, for men’s professional and college basketball</a>.</li>
<li><a href="https://saiemgilani.github.io/wehoop/">wehoop, for women’s professional and college basketball</a>.</li>
<li><a href="https://billpetti.github.io/baseballr/">baseballr, for professional and college baseball</a>.</li>
<li><a href="https://jaseziv.github.io/worldfootballR/">worldfootballR, for soccer data from around the world</a>.</li>
<li><a href="https://hockeyr.netlify.app/">hockeyR, for NHL hockey data</a></li>
<li><a href="https://saiemgilani.github.io/recruitR/">recruitR, for college sports recruiting</a></li>
</ul>
<p>Not part of the SportsDataverse, but in the same neighborhood, is <a href="https://www.nflfastr.com/">nflfastR</a>, which can provide NFL play-by-play data.</p>
<p>Because they’re all under development, not all of them can be installed with just a simple <code>install.packages("something")</code>. Some require a little work, some require API keys.</p>
<p>The main issue for you is to read the documentation carefully.</p>
<div id="using-cfbfastr-as-a-cautionary-tale" class="section level2" number="41.1">
<h2><span class="header-section-number">41.1</span> Using cfbfastR as a cautionary tale</h2>
<p>cfbfastR presents us a good view into the promise and peril of libraries like this.</p>
<p><a href="https://saiemgilani.github.io/cfbfastR/">First, to make this work, follow the installation instructions</a> and then follow how to get an API key from College Football Data and how to add that to your environment. But maybe wait to do that until you read the whole section.</p>
<p>After installations, we can load it up.</p>
<div class="sourceCode" id="cb677"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb677-1"><a href="using-packages-to-get-data.html#cb677-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb677-2"><a href="using-packages-to-get-data.html#cb677-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cfbfastR)</span></code></pre></div>
<p>You might be thinking, “Oh wow, I can get play by play data for college football. Let’s look at what are the five most heartbreaking plays of this doomed Nebraska season.” Because what better way to determine doom than by looking at the steepest dropoff in win probability, which is included in the data.</p>
<p>Great idea. Let’s do it.</p>
<p>The first thing to do is <a href="https://saiemgilani.github.io/cfbfastR/reference/cfbd_pbp_data.html">read the documentation</a>. You’ll see that you can request data for each week. For example, here’s week 2, which is actually Nebraska’s third game (the week 0 game is lumped in with week 1).</p>
<div class="sourceCode" id="cb678"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb678-1"><a href="using-packages-to-get-data.html#cb678-1" aria-hidden="true" tabindex="-1"></a>nebraska <span class="ot">&lt;-</span> <span class="fu">cfbd_pbp_data</span>(</span>
<span id="cb678-2"><a href="using-packages-to-get-data.html#cb678-2" aria-hidden="true" tabindex="-1"></a> <span class="dv">2021</span>,</span>
<span id="cb678-3"><a href="using-packages-to-get-data.html#cb678-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">week=</span><span class="dv">2</span>, </span>
<span id="cb678-4"><a href="using-packages-to-get-data.html#cb678-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">season_type =</span> <span class="st">&quot;regular&quot;</span>,</span>
<span id="cb678-5"><a href="using-packages-to-get-data.html#cb678-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">team =</span> <span class="st">&quot;Nebraska&quot;</span>,</span>
<span id="cb678-6"><a href="using-packages-to-get-data.html#cb678-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">epa_wpa =</span> <span class="cn">TRUE</span>,</span>
<span id="cb678-7"><a href="using-packages-to-get-data.html#cb678-7" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## • 21:23:38 | Start processing of 1 game...</code></pre>
<p>There’s not an easy way to get all of a single team’s games. A way to do it that’s not very pretty but it works is like this:</p>
<div class="sourceCode" id="cb680"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb680-1"><a href="using-packages-to-get-data.html#cb680-1" aria-hidden="true" tabindex="-1"></a>wk1 <span class="ot">&lt;-</span> <span class="fu">cfbd_pbp_data</span>(<span class="dv">2021</span>, <span class="at">week=</span><span class="dv">1</span>, <span class="at">season_type =</span> <span class="st">&quot;regular&quot;</span>, <span class="at">team =</span> <span class="st">&quot;Nebraska&quot;</span>, <span class="at">epa_wpa =</span> <span class="cn">TRUE</span>)</span>
<span id="cb680-2"><a href="using-packages-to-get-data.html#cb680-2" aria-hidden="true" tabindex="-1"></a><span class="fu">Sys.sleep</span>(<span class="dv">2</span>)</span>
<span id="cb680-3"><a href="using-packages-to-get-data.html#cb680-3" aria-hidden="true" tabindex="-1"></a>wk2 <span class="ot">&lt;-</span> <span class="fu">cfbd_pbp_data</span>(<span class="dv">2021</span>, <span class="at">week=</span><span class="dv">2</span>, <span class="at">season_type =</span> <span class="st">&quot;regular&quot;</span>, <span class="at">team =</span> <span class="st">&quot;Nebraska&quot;</span>, <span class="at">epa_wpa =</span> <span class="cn">TRUE</span>)</span>
<span id="cb680-4"><a href="using-packages-to-get-data.html#cb680-4" aria-hidden="true" tabindex="-1"></a><span class="fu">Sys.sleep</span>(<span class="dv">2</span>)</span>
<span id="cb680-5"><a href="using-packages-to-get-data.html#cb680-5" aria-hidden="true" tabindex="-1"></a>wk3 <span class="ot">&lt;-</span> <span class="fu">cfbd_pbp_data</span>(<span class="dv">2021</span>, <span class="at">week=</span><span class="dv">3</span>, <span class="at">season_type =</span> <span class="st">&quot;regular&quot;</span>, <span class="at">team =</span> <span class="st">&quot;Nebraska&quot;</span>, <span class="at">epa_wpa =</span> <span class="cn">TRUE</span>)</span>
<span id="cb680-6"><a href="using-packages-to-get-data.html#cb680-6" aria-hidden="true" tabindex="-1"></a><span class="fu">Sys.sleep</span>(<span class="dv">2</span>)</span>
<span id="cb680-7"><a href="using-packages-to-get-data.html#cb680-7" aria-hidden="true" tabindex="-1"></a>wk4 <span class="ot">&lt;-</span> <span class="fu">cfbd_pbp_data</span>(<span class="dv">2021</span>, <span class="at">week=</span><span class="dv">4</span>, <span class="at">season_type =</span> <span class="st">&quot;regular&quot;</span>, <span class="at">team =</span> <span class="st">&quot;Nebraska&quot;</span>, <span class="at">epa_wpa =</span> <span class="cn">TRUE</span>)</span>
<span id="cb680-8"><a href="using-packages-to-get-data.html#cb680-8" aria-hidden="true" tabindex="-1"></a><span class="fu">Sys.sleep</span>(<span class="dv">2</span>)</span>
<span id="cb680-9"><a href="using-packages-to-get-data.html#cb680-9" aria-hidden="true" tabindex="-1"></a>wk5 <span class="ot">&lt;-</span> <span class="fu">cfbd_pbp_data</span>(<span class="dv">2021</span>, <span class="at">week=</span><span class="dv">5</span>, <span class="at">season_type =</span> <span class="st">&quot;regular&quot;</span>, <span class="at">team =</span> <span class="st">&quot;Nebraska&quot;</span>, <span class="at">epa_wpa =</span> <span class="cn">TRUE</span>)</span>
<span id="cb680-10"><a href="using-packages-to-get-data.html#cb680-10" aria-hidden="true" tabindex="-1"></a><span class="fu">Sys.sleep</span>(<span class="dv">2</span>)</span>
<span id="cb680-11"><a href="using-packages-to-get-data.html#cb680-11" aria-hidden="true" tabindex="-1"></a>wk6 <span class="ot">&lt;-</span> <span class="fu">cfbd_pbp_data</span>(<span class="dv">2021</span>, <span class="at">week=</span><span class="dv">6</span>, <span class="at">season_type =</span> <span class="st">&quot;regular&quot;</span>, <span class="at">team =</span> <span class="st">&quot;Nebraska&quot;</span>, <span class="at">epa_wpa =</span> <span class="cn">TRUE</span>)</span>
<span id="cb680-12"><a href="using-packages-to-get-data.html#cb680-12" aria-hidden="true" tabindex="-1"></a><span class="fu">Sys.sleep</span>(<span class="dv">2</span>)</span>
<span id="cb680-13"><a href="using-packages-to-get-data.html#cb680-13" aria-hidden="true" tabindex="-1"></a>wk7 <span class="ot">&lt;-</span> <span class="fu">cfbd_pbp_data</span>(<span class="dv">2021</span>, <span class="at">week=</span><span class="dv">7</span>, <span class="at">season_type =</span> <span class="st">&quot;regular&quot;</span>, <span class="at">team =</span> <span class="st">&quot;Nebraska&quot;</span>, <span class="at">epa_wpa =</span> <span class="cn">TRUE</span>)</span>
<span id="cb680-14"><a href="using-packages-to-get-data.html#cb680-14" aria-hidden="true" tabindex="-1"></a><span class="fu">Sys.sleep</span>(<span class="dv">2</span>)</span>
<span id="cb680-15"><a href="using-packages-to-get-data.html#cb680-15" aria-hidden="true" tabindex="-1"></a>wk9 <span class="ot">&lt;-</span> <span class="fu">cfbd_pbp_data</span>(<span class="dv">2021</span>, <span class="at">week=</span><span class="dv">9</span>, <span class="at">season_type =</span> <span class="st">&quot;regular&quot;</span>, <span class="at">team =</span> <span class="st">&quot;Nebraska&quot;</span>, <span class="at">epa_wpa =</span> <span class="cn">TRUE</span>)</span>
<span id="cb680-16"><a href="using-packages-to-get-data.html#cb680-16" aria-hidden="true" tabindex="-1"></a><span class="fu">Sys.sleep</span>(<span class="dv">2</span>)</span>
<span id="cb680-17"><a href="using-packages-to-get-data.html#cb680-17" aria-hidden="true" tabindex="-1"></a>wk10 <span class="ot">&lt;-</span> <span class="fu">cfbd_pbp_data</span>(<span class="dv">2021</span>, <span class="at">week=</span><span class="dv">10</span>, <span class="at">season_type =</span> <span class="st">&quot;regular&quot;</span>, <span class="at">team =</span> <span class="st">&quot;Nebraska&quot;</span>, <span class="at">epa_wpa =</span> <span class="cn">TRUE</span>)</span>
<span id="cb680-18"><a href="using-packages-to-get-data.html#cb680-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb680-19"><a href="using-packages-to-get-data.html#cb680-19" aria-hidden="true" tabindex="-1"></a>nuplays <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(wk1, wk2, wk3, wk4, wk5, wk6, wk7, wk9, wk10)</span></code></pre></div>
<p>The sys.sleep bits just pauses for two seconds before running the next block. Since we’re requesting data from someone else’s computer, we want to be kind. Week 8 was a bye week for Nebraska, so if you request it, you’ll get an empty request and a warning. The <code>bind_rows</code> parts puts all the dataframes into a single dataframe.</p>
<p>Now you’re ready to look at heartbreak. How do we define heartbreak? How about like this: you first have to lose the game, it comes in the third or fourth quarter, it involves a play (i.e. not a timeout), and it results in the biggest drop in win probability.</p>
<div class="sourceCode" id="cb681"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb681-1"><a href="using-packages-to-get-data.html#cb681-1" aria-hidden="true" tabindex="-1"></a>nuplays <span class="sc">%&gt;%</span> </span>
<span id="cb681-2"><a href="using-packages-to-get-data.html#cb681-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(pos_team <span class="sc">==</span> <span class="st">&quot;Nebraska&quot;</span> <span class="sc">&amp;</span> def_pos_team <span class="sc">!=</span> <span class="st">&quot;Fordham&quot;</span> <span class="sc">&amp;</span> def_pos_team <span class="sc">!=</span> <span class="st">&quot;Buffalo&quot;</span> <span class="sc">&amp;</span> def_pos_team <span class="sc">!=</span> <span class="st">&quot;Northwestern&quot;</span> <span class="sc">&amp;</span> play_type <span class="sc">!=</span> <span class="st">&quot;Timeout&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb681-3"><a href="using-packages-to-get-data.html#cb681-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(period <span class="sc">==</span> <span class="dv">3</span> <span class="sc">|</span> period <span class="sc">==</span> <span class="dv">4</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb681-4"><a href="using-packages-to-get-data.html#cb681-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">HeartbreakLevel =</span> wp_before <span class="sc">-</span> wp_after) <span class="sc">%&gt;%</span> </span>
<span id="cb681-5"><a href="using-packages-to-get-data.html#cb681-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(HeartbreakLevel)) <span class="sc">%&gt;%</span> </span>
<span id="cb681-6"><a href="using-packages-to-get-data.html#cb681-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">top_n</span>(<span class="dv">5</span>, <span class="at">wt=</span>HeartbreakLevel) <span class="sc">%&gt;%</span></span>
<span id="cb681-7"><a href="using-packages-to-get-data.html#cb681-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(period, clock.minutes, def_pos_team, play_type, play_text)</span></code></pre></div>
<pre><code>##   period clock.minutes   def_pos_team                  play_type
## 1      4             1       Michigan Fumble Recovery (Opponent)
## 2      4             1 Michigan State                       Punt
## 3      4            14 Michigan State                       Sack
## 4      3            10         Purdue        Interception Return
## 5      4             3 Michigan State      Punt Return Touchdown
##                                                                                                                                                        play_text
## 1 Adrian Martinez run for 3 yds to the Neb 18 Adrian Martinez fumbled, forced by Brad Hawkins, recovered by Mich Brad Hawkins  , return for 19 yds to the Neb 18
## 2                                                                                    William Przystup punt for 42 yds, fair catch by Jayden Reed at the MchSt 25
## 3                                                                                                               Adrian Martinez sacked for 0 yards to the Neb 45
## 4                                                                                            Adrian Martinez pass intercepted return for no gain to the Prdue 41
## 5                                                                    Daniel Cerni punt for 34 yds , Jayden Reed returns for 62 yds for a TD, (Matt Coghlin KICK)</code></pre>
<p>The most heartbreaking play of the season? A fourth quarter fumble against Michigan. Next up: Basically the entire fourth quarter against Michigan State.</p>
</div>
<div id="another-example" class="section level2" number="41.2">
<h2><span class="header-section-number">41.2</span> Another example</h2>
<p>The wehoop package is mature enough to have a version on CRAN, so you can install it the usual way with <code>install.packages("wehoop")</code>. Another helpful library to install is progressr with <code>install.packages("progressr")</code></p>
<div class="sourceCode" id="cb683"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb683-1"><a href="using-packages-to-get-data.html#cb683-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(wehoop)</span></code></pre></div>
<p>Many of these libraries have more than play-by-play data. For example, wehoop has box scores and player data for both the WNBA and college basketball. From personal experience, WNBA data isn’t hard to get, but women’s college basketball is a giant pain.</p>
<p>So, who is Nebraska’s single season points champion over the last five seasons?</p>
<div class="sourceCode" id="cb684"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb684-1"><a href="using-packages-to-get-data.html#cb684-1" aria-hidden="true" tabindex="-1"></a>progressr<span class="sc">::</span><span class="fu">with_progress</span>({</span>
<span id="cb684-2"><a href="using-packages-to-get-data.html#cb684-2" aria-hidden="true" tabindex="-1"></a>  wbb_player_box <span class="ot">&lt;-</span> wehoop<span class="sc">::</span><span class="fu">load_wbb_player_box</span>(<span class="dv">2017</span><span class="sc">:</span><span class="dv">2021</span>)</span>
<span id="cb684-3"><a href="using-packages-to-get-data.html#cb684-3" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<p>With progressr, you’ll see a progress bar in the console, which lets you know that your command is still working, since some of these requests take minutes to complete. Player box scores is quicker – five seasons was a matter of seconds.</p>
<p>If you look at the wbb_player_box data we now have, we have each player in each game over each season – more than 300,000 records. Finding out who Nebraska’s top 10 single-season scoring leaders are is a matter of grouping, summing and filtering.</p>
<div class="sourceCode" id="cb685"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb685-1"><a href="using-packages-to-get-data.html#cb685-1" aria-hidden="true" tabindex="-1"></a>wbb_player_box <span class="sc">%&gt;%</span> </span>
<span id="cb685-2"><a href="using-packages-to-get-data.html#cb685-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(team_short_display_name <span class="sc">==</span> <span class="st">&quot;Nebraska&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb685-3"><a href="using-packages-to-get-data.html#cb685-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(athlete_display_name, season) <span class="sc">%&gt;%</span> </span>
<span id="cb685-4"><a href="using-packages-to-get-data.html#cb685-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">totalPoints =</span> <span class="fu">sum</span>(<span class="fu">as.numeric</span>(pts))) <span class="sc">%&gt;%</span> </span>
<span id="cb685-5"><a href="using-packages-to-get-data.html#cb685-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(totalPoints)) <span class="sc">%&gt;%</span></span>
<span id="cb685-6"><a href="using-packages-to-get-data.html#cb685-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb685-7"><a href="using-packages-to-get-data.html#cb685-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">top_n</span>(<span class="dv">10</span>, <span class="at">wt=</span>totalPoints)</span></code></pre></div>
<pre><code>## # A tibble: 10 × 3
##    athlete_display_name season totalPoints
##    &lt;chr&gt;                 &lt;int&gt;       &lt;dbl&gt;
##  1 Jessica Shepard        2017         538
##  2 Sam Haiby              2021         438
##  3 Leigha Brown           2020         433
##  4 Hannah Whitish         2018         391
##  5 Kate Cain              2018         312
##  6 Isabelle Bourne        2021         300
##  7 Sam Haiby              2020         300
##  8 Hannah Whitish         2019         292
##  9 Sam Haiby              2019         285
## 10 Maddie Simon           2018         282</code></pre>
<p>This just in: Sam Haiby is good at basketball.</p>
</div>
<div id="one-more-futbol-is-life" class="section level2" number="41.3">
<h2><span class="header-section-number">41.3</span> One more: Futbol is life</h2>
<p>For more than a few of these libraries, you’ll need the devtools library, which you can get with <code>install.packages("devtools")</code>.</p>
<p>To get worldfootballR, you’ll use devtools like this: <code>devtools::install_github("JaseZiv/worldfootballR")</code></p>
<div class="sourceCode" id="cb687"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb687-1"><a href="using-packages-to-get-data.html#cb687-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(worldfootballR)</span></code></pre></div>
<p>Each library has a <a href="https://jaseziv.github.io/worldfootballR/reference/index.html">reference page</a>, which all of the functions in it. They also have articles that you can find in a menu bar at the top of the page. Those articles will walk you through examples of how to get the data.</p>
<p>Pretend for a moment that I’m doing a project on why Antonio Conte is primed for success at Tottenham. I want to look at possession metrics in the Premiere League, so I can get that like this:</p>
<div class="sourceCode" id="cb688"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb688-1"><a href="using-packages-to-get-data.html#cb688-1" aria-hidden="true" tabindex="-1"></a>prem_2021_possessison <span class="ot">&lt;-</span> <span class="fu">get_season_team_stats</span>(<span class="at">country =</span> <span class="st">&quot;ENG&quot;</span>, <span class="at">gender =</span> <span class="st">&quot;M&quot;</span>, <span class="at">season_end_year =</span> <span class="st">&quot;2021&quot;</span>, <span class="at">tier =</span> <span class="st">&quot;1st&quot;</span>, <span class="at">stat_type =</span> <span class="st">&quot;possession&quot;</span>)</span></code></pre></div>
<pre><code>## Scraping season possession stats</code></pre>
<p>The data I get shows possession metrics for the team, and for their opponents, so I’m going to filter it to just what the team is mustering. And I’m going to separate Tottenham.</p>
<div class="sourceCode" id="cb690"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb690-1"><a href="using-packages-to-get-data.html#cb690-1" aria-hidden="true" tabindex="-1"></a>team_possession <span class="ot">&lt;-</span> prem_2021_possessison <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Team_or_Opponent <span class="sc">==</span> <span class="st">&quot;team&quot;</span>)</span>
<span id="cb690-2"><a href="using-packages-to-get-data.html#cb690-2" aria-hidden="true" tabindex="-1"></a>spurs <span class="ot">&lt;-</span> team_possession <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Squad <span class="sc">==</span> <span class="st">&quot;Tottenham&quot;</span>)</span></code></pre></div>
<p>And now I can go straight to charting:</p>
<div class="sourceCode" id="cb691"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb691-1"><a href="using-packages-to-get-data.html#cb691-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb691-2"><a href="using-packages-to-get-data.html#cb691-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">data=</span>team_possession, <span class="fu">aes</span>(<span class="at">x=</span><span class="fu">reorder</span>(Squad, Poss), <span class="at">weight=</span>Poss)) <span class="sc">+</span></span>
<span id="cb691-3"><a href="using-packages-to-get-data.html#cb691-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">data=</span>spurs, <span class="fu">aes</span>(<span class="at">x=</span><span class="fu">reorder</span>(Squad, Poss), <span class="at">weight=</span>Poss), <span class="at">fill=</span><span class="st">&quot;#132257&quot;</span>) <span class="sc">+</span> </span>
<span id="cb691-4"><a href="using-packages-to-get-data.html#cb691-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span> </span>
<span id="cb691-5"><a href="using-packages-to-get-data.html#cb691-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb691-6"><a href="using-packages-to-get-data.html#cb691-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">title=</span><span class="st">&quot;Conte&#39;s work ahead: more possesssion&quot;</span>,</span>
<span id="cb691-7"><a href="using-packages-to-get-data.html#cb691-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle=</span><span class="st">&quot;Spurs new boss inherits a team mid-table in possessing the ball.&quot;</span>,</span>
<span id="cb691-8"><a href="using-packages-to-get-data.html#cb691-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption=</span><span class="st">&quot;Source: FBRef.com | By Matt Waite&quot;</span>,</span>
<span id="cb691-9"><a href="using-packages-to-get-data.html#cb691-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">y=</span><span class="st">&quot;Percent of minutes in possession&quot;</span></span>
<span id="cb691-10"><a href="using-packages-to-get-data.html#cb691-10" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb691-11"><a href="using-packages-to-get-data.html#cb691-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb691-12"><a href="using-packages-to-get-data.html#cb691-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb691-13"><a href="using-packages-to-get-data.html#cb691-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>),</span>
<span id="cb691-14"><a href="using-packages-to-get-data.html#cb691-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb691-15"><a href="using-packages-to-get-data.html#cb691-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.y =</span> <span class="fu">element_blank</span>()</span>
<span id="cb691-16"><a href="using-packages-to-get-data.html#cb691-16" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="SportsData_files/figure-html/unnamed-chunk-476-1.png" width="672" /></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="project-checklist.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="appendix.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["SportsData.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
