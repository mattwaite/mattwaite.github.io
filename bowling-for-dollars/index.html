<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rodney's Bowling For Dollars</title>
    <style>
        /* General page setup */
        body {
            background-color: #333;
            color: #fff;
            font-family: 'Courier New', Courier, monospace;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            margin: 0;
            overflow: hidden;
        }

        /* NEW: Branding section */
        #branding {
            text-align: center;
            margin-bottom: 20px;
        }
        #branding h1 {
            color: #00F000; /* Green */
            margin: 0;
            letter-spacing: 2px;
        }
        #branding p {
            max-width: 480px; /* Match game width */
            font-size: 14px;
            margin: 5px 0 0 0;
        }

        /* The main game window */
        #game-container {
            width: 480px;
            height: 320px;
            background-color: #A0522D; /* Atari brown background */
            position: relative;
            overflow: hidden;
            border: 2px solid #000;
            transform: scale(1.5); /* Scale up the game */
            image-rendering: pixelated;
            image-rendering: -moz-crisp-edges;
            image-rendering: crisp-edges;
        }

        /* The blue lines defining the lane */
        .lane-line {
            position: absolute;
            width: 100%; 
            height: 4px;  
            left: 0;
            background-color: #0000AA; 
        }
        #line-top {
            top: 40px; 
        }
        #line-bottom {
            bottom: 40px; 
        }

        /* The player's bowler */
        #bowler {
            position: absolute;
            width: 24px; 
            height: 32px;
            left: 20px; 
            top: 144px; 
              background-image: url('bowler.png');
              background-size: cover;
            background-color: #00C000; /* Placeholder green */
        }

        /* The bowling ball */
        #ball {
            position: absolute;
            width: 10px;
            height: 10px;
            background-color: #0000AA;
            border-radius: 50%;
            left: 70px; 
            top: 155px;
            display: none; 
        }

        /* A single bowling pin */
        .pin {
            position: absolute;
            width: 8px; 
            height: 16px; 
            background-color: #008000; /* Green for dollar bill */
            border: 1px solid #004000; /* Darker green border */
            box-sizing: border-box; 
        }

        /* The scoreboard display */
        #scoreboard {
            position: absolute;
            top: 10px;
            right: 10px;
            font-size: 24px;
            color: #00F000; /* Green score */
            letter-spacing: 4px;
        }

        /* NEW: Frame Display */
        #frame-display {
            position: absolute;
            top: 10px;
            left: 10px;
            font-size: 20px;
            color: #00F000;
        }

        /* NEW: Game Over Screen */
        #game-over-screen {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.85);
            color: #fff;
            /* Use flex to center content */
            display: none; 
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            z-index: 10;
        }
        #game-over-screen h2 {
            color: #00F000;
            font-size: 32px;
            margin: 0;
        }
        #game-over-screen p {
            font-size: 18px;
            margin: 10px 0;
        }


        /* Instructions text */
        #controls {
            margin-top: 60px; /* Account for game scaling */
            text-align: center;
        }
    </style>
</head>
<body>

    <div id="branding">
        <h1>Rodney's Bowling For Dollars</h1>
        <p>Chancellor Rodney Bennett has to cut the budget $27.5 million dollars. See how much he can cut with his budget bowling ball.</p>
    </div>

    <div id="game-container">
        <div class="lane-line" id="line-top"></div>
        <div class="lane-line" id="line-bottom"></div>
        
        <div id="scoreboard">00</div>
        <div id="frame-display">Frame: 1</div> <div id="ball"></div>
        <div id="bowler"></div>

        <div id="game-over-screen">
            </div>
    </div>

    <div id="controls">
        <p>Use <strong>ArrowUp / ArrowDown</strong> to move bowler.</p>
        <p>Press <strong>Space</strong> to roll.</p>
        <p>Use <strong>ArrowUp / ArrowDown</strong> while ball is rolling to "hook".</p>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Get all game elements
            const gameContainer = document.getElementById('game-container');
            const bowler = document.getElementById('bowler');
            const ball = document.getElementById('ball');
            const scoreboard = document.getElementById('scoreboard');
            const frameDisplay = document.getElementById('frame-display'); // NEW
            const gameOverScreen = document.getElementById('game-over-screen'); // NEW

            // Game constants
            const LANE_WIDTH = 480;
            const LANE_HEIGHT = 320;
            const BOWLER_WIDTH = 24;
            const BOWLER_HEIGHT = 32;
            const BALL_WIDTH = 10;
            const BALL_HEIGHT = 10;
            const PIN_WIDTH = 8;
            const PIN_HEIGHT = 16;
            
            const GUTTER_TOP = 40;  
            const GUTTER_BOTTOM = 280; 
            const PIN_AREA_LEFT = 350; 
            const PIN_CENTER_Y = 160;
            const MAX_FRAMES = 10; // NEW

            // Game state variables
            let bowlerX = 20; 
            let bowlerY = 144; 
            let ballX = 0;
            let ballY = 0;
            let ballDx = 5; 
            let ballDy = 0; 
            
            let rolling = false;
            let score = 0;
            let pins = [];
            let ballCount = 0;
            let frame = 1;
            let gameOver = false; // NEW

            // Pin layout
            const pinPositions = [
                { x: PIN_AREA_LEFT + 10, y: PIN_CENTER_Y - (PIN_HEIGHT/2) }, // Pin 1 
                { x: PIN_AREA_LEFT + 20, y: PIN_CENTER_Y - 10 - (PIN_HEIGHT/2) }, // Pin 2
                { x: PIN_AREA_LEFT + 20, y: PIN_CENTER_Y + 10 - (PIN_HEIGHT/2) }, // Pin 3
                { x: PIN_AREA_LEFT + 30, y: PIN_CENTER_Y - 20 - (PIN_HEIGHT/2) }, // Pin 4
                { x: PIN_AREA_LEFT + 30, y: PIN_CENTER_Y - (PIN_HEIGHT/2) },       // Pin 5
                { x: PIN_AREA_LEFT + 30, y: PIN_CENTER_Y + 20 - (PIN_HEIGHT/2) }, // Pin 6
                { x: PIN_AREA_LEFT + 40, y: PIN_CENTER_Y - 30 - (PIN_HEIGHT/2) }, // Pin 7
                { x: PIN_AREA_LEFT + 40, y: PIN_CENTER_Y - 10 - (PIN_HEIGHT/2) }, // Pin 8
                { x: PIN_AREA_LEFT + 40, y: PIN_CENTER_Y + 10 - (PIN_HEIGHT/2) }, // Pin 9
                { x: PIN_AREA_LEFT + 40, y: PIN_CENTER_Y + 30 - (PIN_HEIGHT/2) }  // Pin 10
            ];

            // --- Game Setup Functions ---

            function createPins() {
                pins.forEach(p => p.element.remove());
                pins = [];

                pinPositions.forEach((pos, index) => {
                    const pinElement = document.createElement('div');
                    pinElement.className = 'pin';
                    pinElement.id = `pin-${index}`;
                    pinElement.style.left = `${pos.x}px`;
                    pinElement.style.top = `${pos.y}px`;
                    gameContainer.appendChild(pinElement);
                    
                    pins.push({
                        element: pinElement,
                        x: pos.x,
                        y: pos.y,
                        width: PIN_WIDTH,
                        height: PIN_HEIGHT,
                        isUp: true 
                    });
                });
            }

            function resetBowler() {
                bowler.style.display = 'block'; // Ensure bowler is visible
                bowlerX = 20;
                bowlerY = 144;
                bowler.style.left = `${bowlerX}px`;
                bowler.style.top = `${bowlerY}px`;
                
                ball.style.display = 'none';
                rolling = false;
                ballDy = 0; 
                ballX = 70; 
                ballY = 155; 
            }

            // UPDATED: resetFrame now updates the frame display
            function resetFrame() {
                createPins();
                resetBowler();
                ballCount = 0; 
                frameDisplay.textContent = `Frame: ${frame}`; // Update display
            }

            // NEW: Generates the end-of-game message
            function getEncouragingMessage(finalScore) {
                const target = 27.5;
                if (finalScore > target) {
                    const surplus = (finalScore - target).toFixed(1);
                    return `Incredible! You cut the $${target} million AND found an extra $${surplus} million!`;
                } else if (finalScore === target) {
                    return `Perfect! You cut exactly $${target} million!`;
                } else {
                    const needed = (target - finalScore).toFixed(1);
                    return `Good effort! You still need to find $${needed} million!`;
                }
            }

            // NEW: Function to end the game
            function endGame() {
                gameOver = true;
                
                // Hide game elements
                bowler.style.display = 'none';
                ball.style.display = 'none';
                pins.forEach(p => p.element.style.display = 'none');

                // Get final message
                const message = getEncouragingMessage(score);
                
                // Show game over screen
                gameOverScreen.innerHTML = `
                    <h2>Game Over!</h2>
                    <p>Your Final Cut: $${score} Million</p>
                    <p>${message}</p>
                `;
                gameOverScreen.style.display = 'flex'; // Show the screen
            }


            // UPDATED: nextBall now checks for frame limit
            function nextBall() {
                ballCount++; 
                const pinsDown = pins.filter(p => !p.isUp).length;

                // Frame ends if:
                // 1. It was a strike (10 pins down on the first ball)
                // 2. It was the second ball (ballCount is now 2)
                const isFrameOver = (pinsDown === 10 && ballCount === 1) || ballCount === 2;

                if (isFrameOver) {
                    if (frame === MAX_FRAMES) {
                        // Game is over!
                        endGame();
                    } else {
                        // Regular end of frame
                        alert(`Frame ${frame} over! Total Pins: ${score}\nResetting for next frame.`);
                        frame++;
                        resetFrame(); // This will reset pins, bowler, and update frame display
                    }
                } else {
                    // It was the first ball, and not a strike.
                    // Just reset the bowler for the second roll.
                    resetBowler();
                }
            }
            
            // --- Input Handling ---

            document.addEventListener('keydown', (e) => {
                if (gameOver) return; // NEW: Stop all input if game is over

                if (rolling) {
                    // --- Ball Hooking Controls ---
                    if (e.key === 'ArrowUp') {
                        ballDy = -1; // Hook up
                    } else if (e.key === 'ArrowDown') {
                        ballDy = 1; // Hook down
                    }
                } else {
                    // --- Bowler Movement Controls ---
                    if (e.key === 'ArrowUp') {
                        bowlerY = Math.max(GUTTER_TOP, bowlerY - 5);
                        bowler.style.top = `${bowlerY}px`;
                    } else if (e.key === 'ArrowDown') {
                        bowlerY = Math.min(GUTTER_BOTTOM - BOWLER_HEIGHT, bowlerY + 5);
                        bowler.style.top = `${bowlerY}px`;
                    } else if (e.key === ' ' || e.key === 'Spacebar') {
                        rollBall();
                    }
                }
            });

            document.addEventListener('keyup', (e) => {
                if (gameOver) return; // NEW
                if (rolling) {
                    if (e.key === 'ArrowUp' || e.key === 'ArrowDown') {
                        ballDy = 0;
                    }
                }
            });

            // --- Game Logic ---

            function rollBall() {
                if (rolling) return;
                rolling = true;
                
                ballX = 70; 
                ballY = bowlerY + (BOWLER_HEIGHT / 2) - (BALL_HEIGHT / 2);
                
                ball.style.left = `${ballX}px`;
                ball.style.top = `${ballY}px`;
                ball.style.display = 'block';

                gameLoop();
            }

            function checkCollision(a, b) {
                return (
                    a.x < b.x + b.width &&
                    a.x + a.width > b.x &&
                    a.y < b.y + b.height &&
                    a.y + a.height > b.y
                );
            }

            function updateScore(pinsHit) {
                score += pinsHit;
                // We're treating 1 pin = $1 million for the scoreboard
                scoreboard.textContent = String(score).padStart(2, '0');
            }

            // --- Main Game Loop ---
            function gameLoop() {
                if (!rolling) return; 

                // 1. Move ball
                ballX += Math.abs(ballDx); 
                ballY += ballDy; 

                // 2. Update ball's DOM position
                ball.style.left = `${ballX}px`;
                ball.style.top = `${ballY}px`;

                // 3. Check for collision with pins
                let pinsHitThisFrame = 0;
                const ballRect = { x: ballX, y: ballY, width: BALL_WIDTH, height: BALL_HEIGHT };

                pins.forEach(pin => {
                    if (pin.isUp) {
                        const pinRect = { x: pin.x, y: pin.y, width: pin.width, height: pin.height };
                        if (checkCollision(ballRect, pinRect)) {
                            pin.isUp = false; 
                            pin.element.style.display = 'none'; 
                            pinsHitThisFrame++;
                        }
                    }
                });
                
                // 4. Update score
                if (pinsHitThisFrame > 0) {
                    updateScore(pinsHitThisFrame);
                }

                // 5. Check for end of roll
                if (ballX > LANE_WIDTH) {
                    rolling = false; 
                    nextBall(); 
                } else {
                    requestAnimationFrame(gameLoop);
                }
            }

            // --- Initialize Game ---
            resetFrame(); 
        });
    </script>
</body>
</html>