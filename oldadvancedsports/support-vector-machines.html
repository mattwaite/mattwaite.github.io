<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 9 Support Vector Machines | Advanced Sports Data Analysis</title>
  <meta name="description" content="This is the companion text to the University of Nebraska-Lincoln’s SPMC 460: Advanced Sports Data Analysis" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 9 Support Vector Machines | Advanced Sports Data Analysis" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is the companion text to the University of Nebraska-Lincoln’s SPMC 460: Advanced Sports Data Analysis" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 9 Support Vector Machines | Advanced Sports Data Analysis" />
  
  <meta name="twitter:description" content="This is the companion text to the University of Nebraska-Lincoln’s SPMC 460: Advanced Sports Data Analysis" />
  

<meta name="author" content="By Matt Waite" />


<meta name="date" content="2022-02-28" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="xgboost-to-make-classifications.html"/>

<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Advanced Sports Data Analysis</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#requirements-and-conventions"><i class="fa fa-check"></i><b>1.1</b> Requirements and Conventions</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#about-this-book"><i class="fa fa-check"></i><b>1.2</b> About this book</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="the-modeling-process-and-linear-regression.html"><a href="the-modeling-process-and-linear-regression.html"><i class="fa fa-check"></i><b>2</b> The modeling process and linear regression</a>
<ul>
<li class="chapter" data-level="2.1" data-path="the-modeling-process-and-linear-regression.html"><a href="the-modeling-process-and-linear-regression.html#feature-engineering"><i class="fa fa-check"></i><b>2.1</b> Feature engineering</a></li>
<li class="chapter" data-level="2.2" data-path="the-modeling-process-and-linear-regression.html"><a href="the-modeling-process-and-linear-regression.html#setting-up-the-modeling-process"><i class="fa fa-check"></i><b>2.2</b> Setting up the modeling process</a></li>
<li class="chapter" data-level="2.3" data-path="the-modeling-process-and-linear-regression.html"><a href="the-modeling-process-and-linear-regression.html#predicting-based-on-the-model"><i class="fa fa-check"></i><b>2.3</b> Predicting based on the model</a></li>
<li class="chapter" data-level="2.4" data-path="the-modeling-process-and-linear-regression.html"><a href="the-modeling-process-and-linear-regression.html#predicting-data-we-havent-seen-before"><i class="fa fa-check"></i><b>2.4</b> Predicting data we haven’t seen before</a></li>
<li class="chapter" data-level="2.5" data-path="the-modeling-process-and-linear-regression.html"><a href="the-modeling-process-and-linear-regression.html#looking-locally"><i class="fa fa-check"></i><b>2.5</b> Looking locally</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="multiple-regression.html"><a href="multiple-regression.html"><i class="fa fa-check"></i><b>3</b> Multiple regression</a>
<ul>
<li class="chapter" data-level="3.1" data-path="multiple-regression.html"><a href="multiple-regression.html#a-multiple-regression-speed-run"><i class="fa fa-check"></i><b>3.1</b> A multiple regression speed run</a></li>
<li class="chapter" data-level="3.2" data-path="multiple-regression.html"><a href="multiple-regression.html#picking-what-moves-the-needle"><i class="fa fa-check"></i><b>3.2</b> Picking what moves the needle</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="decision-trees-and-random-forests.html"><a href="decision-trees-and-random-forests.html"><i class="fa fa-check"></i><b>4</b> Decision trees and random forests</a>
<ul>
<li class="chapter" data-level="4.1" data-path="decision-trees-and-random-forests.html"><a href="decision-trees-and-random-forests.html#an-intro-to-pre-processing"><i class="fa fa-check"></i><b>4.1</b> An intro to pre-processing</a></li>
<li class="chapter" data-level="4.2" data-path="decision-trees-and-random-forests.html"><a href="decision-trees-and-random-forests.html#decision-trees"><i class="fa fa-check"></i><b>4.2</b> Decision trees</a></li>
<li class="chapter" data-level="4.3" data-path="decision-trees-and-random-forests.html"><a href="decision-trees-and-random-forests.html#random-forest"><i class="fa fa-check"></i><b>4.3</b> Random forest</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="xgboost.html"><a href="xgboost.html"><i class="fa fa-check"></i><b>5</b> XGBoost</a>
<ul>
<li class="chapter" data-level="5.1" data-path="xgboost.html"><a href="xgboost.html#hyperparameters"><i class="fa fa-check"></i><b>5.1</b> Hyperparameters</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="logistic-regression.html"><a href="logistic-regression.html"><i class="fa fa-check"></i><b>6</b> Logistic Regression</a>
<ul>
<li class="chapter" data-level="6.1" data-path="logistic-regression.html"><a href="logistic-regression.html#visualizing-the-decision-boundary"><i class="fa fa-check"></i><b>6.1</b> Visualizing the decision boundary</a></li>
<li class="chapter" data-level="6.2" data-path="logistic-regression.html"><a href="logistic-regression.html#the-logistic-regression"><i class="fa fa-check"></i><b>6.2</b> The logistic regression</a></li>
<li class="chapter" data-level="6.3" data-path="logistic-regression.html"><a href="logistic-regression.html#evaluating-the-fit"><i class="fa fa-check"></i><b>6.3</b> Evaluating the fit</a></li>
<li class="chapter" data-level="6.4" data-path="logistic-regression.html"><a href="logistic-regression.html#comparing-it-to-test-data"><i class="fa fa-check"></i><b>6.4</b> Comparing it to test data</a></li>
<li class="chapter" data-level="6.5" data-path="logistic-regression.html"><a href="logistic-regression.html#how-well-did-it-do-with-nebraska"><i class="fa fa-check"></i><b>6.5</b> How well did it do with Nebraska?</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="using-random-forests-to-predict-winners.html"><a href="using-random-forests-to-predict-winners.html"><i class="fa fa-check"></i><b>7</b> Using random forests to predict winners</a>
<ul>
<li class="chapter" data-level="7.1" data-path="using-random-forests-to-predict-winners.html"><a href="using-random-forests-to-predict-winners.html#setup"><i class="fa fa-check"></i><b>7.1</b> Setup</a></li>
<li class="chapter" data-level="7.2" data-path="using-random-forests-to-predict-winners.html"><a href="using-random-forests-to-predict-winners.html#predicting-a-future-game"><i class="fa fa-check"></i><b>7.2</b> Predicting a future game</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="xgboost-to-make-classifications.html"><a href="xgboost-to-make-classifications.html"><i class="fa fa-check"></i><b>8</b> XGBoost to make classifications</a></li>
<li class="chapter" data-level="9" data-path="support-vector-machines.html"><a href="support-vector-machines.html"><i class="fa fa-check"></i><b>9</b> Support Vector Machines</a>
<ul>
<li class="chapter" data-level="9.1" data-path="support-vector-machines.html"><a href="support-vector-machines.html#recipes"><i class="fa fa-check"></i><b>9.1</b> Recipes</a></li>
<li class="chapter" data-level="9.2" data-path="support-vector-machines.html"><a href="support-vector-machines.html#models"><i class="fa fa-check"></i><b>9.2</b> Models</a></li>
<li class="chapter" data-level="9.3" data-path="support-vector-machines.html"><a href="support-vector-machines.html#workflows"><i class="fa fa-check"></i><b>9.3</b> Workflows</a></li>
<li class="chapter" data-level="9.4" data-path="support-vector-machines.html"><a href="support-vector-machines.html#logistic-regression-1"><i class="fa fa-check"></i><b>9.4</b> Logistic regression</a></li>
<li class="chapter" data-level="9.5" data-path="support-vector-machines.html"><a href="support-vector-machines.html#random-forest-1"><i class="fa fa-check"></i><b>9.5</b> Random forest</a></li>
<li class="chapter" data-level="9.6" data-path="support-vector-machines.html"><a href="support-vector-machines.html#support-vector-machine"><i class="fa fa-check"></i><b>9.6</b> Support Vector Machine</a></li>
<li class="chapter" data-level="9.7" data-path="support-vector-machines.html"><a href="support-vector-machines.html#bottom-line"><i class="fa fa-check"></i><b>9.7</b> Bottom line</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Advanced Sports Data Analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="support-vector-machines" class="section level1" number="9">
<h1><span class="header-section-number">Chapter 9</span> Support Vector Machines</h1>
<p>The last method of statistical learning that we’ll use is the Support Vector Machine. The concept to understand about the support vector machine is the concept of a hyperplane. First think of a hyperplane as a line – a means to separate wins and losses along an axis where a certain stat says this way is a win and that way is a loss. Each dot in the scatter plot is a support vector. The hyperplane separates the support vectors into their classes – it’s the line between winning and losing. When you have just two stats like that, it’s pretty easy. Where support vector machines get hard is when you have many predictors that create the hyperplane. Then, instead of a line, it becomes a multidimensional shape in a multidimensional space.</p>
<p>The further away from our hyperplane, the more confident we are in the prediction.</p>
<p>We’re going to implement a support vector machine along side a logistic regression and a random forest. Simultaneously, we’re going to evaluate if rolling metrics or cumulative metrics are better at predicting the outcome of games. As such, this is going to involve a lot of code, but most of it will be repetitive.</p>
<p>Let’s start with our libraries, per usual.</p>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb206-1"><a href="support-vector-machines.html#cb206-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb206-2"><a href="support-vector-machines.html#cb206-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidymodels)</span>
<span id="cb206-3"><a href="support-vector-machines.html#cb206-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(zoo)</span>
<span id="cb206-4"><a href="support-vector-machines.html#cb206-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(hoopR)</span>
<span id="cb206-5"><a href="support-vector-machines.html#cb206-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb206-6"><a href="support-vector-machines.html#cb206-6" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span></code></pre></div>
<p>Now we’re going to add cumulative measures to our feature engineering.</p>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb207-1"><a href="support-vector-machines.html#cb207-1" aria-hidden="true" tabindex="-1"></a>teamgames <span class="ot">&lt;-</span> <span class="fu">load_mbb_team_box</span>(<span class="at">seasons =</span> <span class="dv">2015</span><span class="sc">:</span><span class="dv">2022</span>) <span class="sc">%&gt;%</span></span>
<span id="cb207-2"><a href="support-vector-machines.html#cb207-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(field_goals_made_field_goals_attempted, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">&quot;field_goals_made&quot;</span>,<span class="st">&quot;field_goals_attempted&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb207-3"><a href="support-vector-machines.html#cb207-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(three_point_field_goals_made_three_point_field_goals_attempted, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">&quot;three_point_field_goals_made&quot;</span>,<span class="st">&quot;three_point_field_goals_attempted&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb207-4"><a href="support-vector-machines.html#cb207-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(free_throws_made_free_throws_attempted, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">&quot;free_throws_made&quot;</span>,<span class="st">&quot;free_throws_attempted&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb207-5"><a href="support-vector-machines.html#cb207-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="dv">12</span><span class="sc">:</span><span class="dv">34</span>, as.numeric)</span>
<span id="cb207-6"><a href="support-vector-machines.html#cb207-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb207-7"><a href="support-vector-machines.html#cb207-7" aria-hidden="true" tabindex="-1"></a>teamstats <span class="ot">&lt;-</span> teamgames <span class="sc">%&gt;%</span> </span>
<span id="cb207-8"><a href="support-vector-machines.html#cb207-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(team_short_display_name, season) <span class="sc">%&gt;%</span></span>
<span id="cb207-9"><a href="support-vector-machines.html#cb207-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(game_date) <span class="sc">%&gt;%</span></span>
<span id="cb207-10"><a href="support-vector-machines.html#cb207-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb207-11"><a href="support-vector-machines.html#cb207-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">team_score =</span> ((field_goals_made<span class="sc">-</span>three_point_field_goals_made) <span class="sc">*</span> <span class="dv">2</span>) <span class="sc">+</span> (three_point_field_goals_made<span class="sc">*</span><span class="dv">3</span>) <span class="sc">+</span> free_throws_made,</span>
<span id="cb207-12"><a href="support-vector-machines.html#cb207-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">true_shooting_percentage =</span> (team_score <span class="sc">/</span> (<span class="dv">2</span><span class="sc">*</span>(field_goals_attempted <span class="sc">+</span> (.<span class="dv">44</span> <span class="sc">*</span> free_throws_attempted)))) <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb207-13"><a href="support-vector-machines.html#cb207-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">turnover_pct =</span> turnovers<span class="sc">/</span>(field_goals_attempted <span class="sc">+</span> <span class="fl">0.44</span> <span class="sc">*</span> free_throws_attempted <span class="sc">+</span> turnovers),</span>
<span id="cb207-14"><a href="support-vector-machines.html#cb207-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">free_throw_factor =</span> free_throws_made<span class="sc">/</span>field_goals_attempted,</span>
<span id="cb207-15"><a href="support-vector-machines.html#cb207-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">team_rolling_true_shooting_percentage =</span> <span class="fu">rollmean</span>(<span class="fu">lag</span>(true_shooting_percentage, <span class="at">n=</span><span class="dv">1</span>), <span class="at">k=</span><span class="dv">10</span>, <span class="at">align=</span><span class="st">&quot;right&quot;</span>, <span class="at">fill=</span><span class="cn">NA</span>),</span>
<span id="cb207-16"><a href="support-vector-machines.html#cb207-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">team_rolling_turnover_percentage =</span> <span class="fu">rollmean</span>(<span class="fu">lag</span>(turnover_pct, <span class="at">n=</span><span class="dv">1</span>), <span class="at">k=</span><span class="dv">10</span>, <span class="at">align=</span><span class="st">&quot;right&quot;</span>, <span class="at">fill=</span><span class="cn">NA</span>),</span>
<span id="cb207-17"><a href="support-vector-machines.html#cb207-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">team_rolling_free_throw_factor =</span> <span class="fu">rollmean</span>(<span class="fu">lag</span>(free_throw_factor, <span class="at">n=</span><span class="dv">1</span>), <span class="at">k=</span><span class="dv">10</span>, <span class="at">align=</span><span class="st">&quot;right&quot;</span>, <span class="at">fill=</span><span class="cn">NA</span>), </span>
<span id="cb207-18"><a href="support-vector-machines.html#cb207-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">team_cumulative_mean_true_shooting =</span> <span class="fu">lag</span>(<span class="fu">cummean</span>(true_shooting_percentage), <span class="at">n=</span><span class="dv">1</span>, <span class="at">default=</span><span class="dv">0</span>),</span>
<span id="cb207-19"><a href="support-vector-machines.html#cb207-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">team_cumulative_mean_turnover_percentage =</span> <span class="fu">lag</span>(<span class="fu">cummean</span>(turnover_pct), <span class="at">n=</span><span class="dv">1</span>, <span class="at">default=</span><span class="dv">0</span>),</span>
<span id="cb207-20"><a href="support-vector-machines.html#cb207-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">team_cumulative_mean_free_throw_factor =</span> <span class="fu">lag</span>(<span class="fu">cummean</span>(free_throw_factor), <span class="at">n=</span><span class="dv">1</span>, <span class="at">default=</span><span class="dv">0</span>)</span>
<span id="cb207-21"><a href="support-vector-machines.html#cb207-21" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> <span class="fu">ungroup</span>()</span>
<span id="cb207-22"><a href="support-vector-machines.html#cb207-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb207-23"><a href="support-vector-machines.html#cb207-23" aria-hidden="true" tabindex="-1"></a>opponent <span class="ot">&lt;-</span> teamstats <span class="sc">%&gt;%</span> <span class="fu">select</span>(game_id, team_id, offensive_rebounds, defensive_rebounds) <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="at">opponent_id=</span>team_id, <span class="at">opponent_offensive_rebounds =</span> offensive_rebounds, <span class="at">opponent_defensive_rebounds=</span>defensive_rebounds) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">opponent_id =</span> <span class="fu">as.numeric</span>(opponent_id))</span>
<span id="cb207-24"><a href="support-vector-machines.html#cb207-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb207-25"><a href="support-vector-machines.html#cb207-25" aria-hidden="true" tabindex="-1"></a>newteamstats <span class="ot">&lt;-</span> teamstats <span class="sc">%&gt;%</span> </span>
<span id="cb207-26"><a href="support-vector-machines.html#cb207-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(opponent) <span class="sc">%&gt;%</span> </span>
<span id="cb207-27"><a href="support-vector-machines.html#cb207-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb207-28"><a href="support-vector-machines.html#cb207-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">orb =</span> offensive_rebounds <span class="sc">/</span> (offensive_rebounds <span class="sc">+</span> opponent_defensive_rebounds),</span>
<span id="cb207-29"><a href="support-vector-machines.html#cb207-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">drb =</span> defensive_rebounds <span class="sc">/</span> (opponent_offensive_rebounds <span class="sc">+</span> defensive_rebounds),</span>
<span id="cb207-30"><a href="support-vector-machines.html#cb207-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">team_rolling_orb =</span> <span class="fu">rollmean</span>(<span class="fu">lag</span>(orb, <span class="at">n=</span><span class="dv">1</span>), <span class="at">k=</span><span class="dv">10</span>, <span class="at">align=</span><span class="st">&quot;right&quot;</span>, <span class="at">fill=</span><span class="cn">NA</span>),</span>
<span id="cb207-31"><a href="support-vector-machines.html#cb207-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">team_rolling_drb =</span> <span class="fu">rollmean</span>(<span class="fu">lag</span>(drb, <span class="at">n=</span><span class="dv">1</span>), <span class="at">k=</span><span class="dv">10</span>, <span class="at">align=</span><span class="st">&quot;right&quot;</span>, <span class="at">fill=</span><span class="cn">NA</span>),</span>
<span id="cb207-32"><a href="support-vector-machines.html#cb207-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">team_cumulative_mean_orb =</span> <span class="fu">lag</span>(<span class="fu">cummean</span>(orb), <span class="at">n=</span><span class="dv">1</span>, <span class="at">default=</span><span class="dv">0</span>),</span>
<span id="cb207-33"><a href="support-vector-machines.html#cb207-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">team_cumulative_mean_drb =</span> <span class="fu">lag</span>(<span class="fu">cummean</span>(drb), <span class="at">n=</span><span class="dv">1</span>, <span class="at">default=</span><span class="dv">0</span>),</span>
<span id="cb207-34"><a href="support-vector-machines.html#cb207-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">team_dummy_home_away =</span> <span class="fu">case_when</span>(</span>
<span id="cb207-35"><a href="support-vector-machines.html#cb207-35" aria-hidden="true" tabindex="-1"></a>      home_away <span class="sc">==</span> <span class="st">&quot;HOME&quot;</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb207-36"><a href="support-vector-machines.html#cb207-36" aria-hidden="true" tabindex="-1"></a>      home_away <span class="sc">==</span> <span class="st">&quot;AWAY&quot;</span> <span class="sc">~</span> <span class="dv">0</span></span>
<span id="cb207-37"><a href="support-vector-machines.html#cb207-37" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb207-38"><a href="support-vector-machines.html#cb207-38" aria-hidden="true" tabindex="-1"></a>    )</span></code></pre></div>
<pre><code>## Joining, by = c(&quot;opponent_id&quot;, &quot;game_id&quot;)</code></pre>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb209-1"><a href="support-vector-machines.html#cb209-1" aria-hidden="true" tabindex="-1"></a>team_side <span class="ot">&lt;-</span> newteamstats <span class="sc">%&gt;%</span></span>
<span id="cb209-2"><a href="support-vector-machines.html#cb209-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(game_id, team_id, team_short_display_name, opponent_id, game_date, season, team_score, team_rolling_true_shooting_percentage, team_rolling_free_throw_factor, team_rolling_turnover_percentage, team_rolling_orb, team_rolling_drb, team_cumulative_mean_true_shooting, team_cumulative_mean_turnover_percentage, team_cumulative_mean_free_throw_factor, team_cumulative_mean_orb, team_cumulative_mean_drb, team_dummy_home_away) <span class="sc">%&gt;%</span> <span class="fu">na.omit</span>()</span>
<span id="cb209-3"><a href="support-vector-machines.html#cb209-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-4"><a href="support-vector-machines.html#cb209-4" aria-hidden="true" tabindex="-1"></a>opponent_side <span class="ot">&lt;-</span> newteamstats <span class="sc">%&gt;%</span></span>
<span id="cb209-5"><a href="support-vector-machines.html#cb209-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(game_id, team_id, team_short_display_name, team_score, team_rolling_true_shooting_percentage, team_rolling_free_throw_factor, team_rolling_turnover_percentage, team_rolling_orb, team_rolling_drb, team_cumulative_mean_true_shooting, team_cumulative_mean_turnover_percentage, team_cumulative_mean_free_throw_factor, team_cumulative_mean_orb, team_cumulative_mean_drb) <span class="sc">%&gt;%</span> <span class="fu">na.omit</span>() <span class="sc">%&gt;%</span></span>
<span id="cb209-6"><a href="support-vector-machines.html#cb209-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(</span>
<span id="cb209-7"><a href="support-vector-machines.html#cb209-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">opponent_id =</span> team_id,</span>
<span id="cb209-8"><a href="support-vector-machines.html#cb209-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">opponent_short_display_name =</span> team_short_display_name,</span>
<span id="cb209-9"><a href="support-vector-machines.html#cb209-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">opponent_score =</span> team_score,</span>
<span id="cb209-10"><a href="support-vector-machines.html#cb209-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">opponent_rolling_true_shooting_percentage =</span> team_rolling_true_shooting_percentage,</span>
<span id="cb209-11"><a href="support-vector-machines.html#cb209-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">opponent_rolling_free_throw_factor =</span> team_rolling_free_throw_factor,</span>
<span id="cb209-12"><a href="support-vector-machines.html#cb209-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">opponent_rolling_turnover_percentage =</span> team_rolling_turnover_percentage,</span>
<span id="cb209-13"><a href="support-vector-machines.html#cb209-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">opponent_rolling_orb =</span> team_rolling_orb,</span>
<span id="cb209-14"><a href="support-vector-machines.html#cb209-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">opponent_rolling_drb =</span> team_rolling_drb,</span>
<span id="cb209-15"><a href="support-vector-machines.html#cb209-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">opponent_cumulative_mean_true_shooting =</span> team_cumulative_mean_true_shooting,</span>
<span id="cb209-16"><a href="support-vector-machines.html#cb209-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">opponent_cumulative_mean_turnover_percentage =</span> team_cumulative_mean_turnover_percentage,</span>
<span id="cb209-17"><a href="support-vector-machines.html#cb209-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">opponent_cumulative_mean_free_throw_factor =</span> team_cumulative_mean_free_throw_factor,</span>
<span id="cb209-18"><a href="support-vector-machines.html#cb209-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">opponent_cumulative_mean_orb =</span> team_cumulative_mean_orb,</span>
<span id="cb209-19"><a href="support-vector-machines.html#cb209-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">opponent_cumulative_mean_drb =</span> team_cumulative_mean_drb</span>
<span id="cb209-20"><a href="support-vector-machines.html#cb209-20" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb209-21"><a href="support-vector-machines.html#cb209-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">opponent_id =</span> <span class="fu">as.numeric</span>(opponent_id))</span>
<span id="cb209-22"><a href="support-vector-machines.html#cb209-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-23"><a href="support-vector-machines.html#cb209-23" aria-hidden="true" tabindex="-1"></a>games <span class="ot">&lt;-</span> team_side <span class="sc">%&gt;%</span> <span class="fu">inner_join</span>(opponent_side) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb209-24"><a href="support-vector-machines.html#cb209-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">TeamResult =</span> <span class="fu">as.factor</span>(<span class="fu">case_when</span>(</span>
<span id="cb209-25"><a href="support-vector-machines.html#cb209-25" aria-hidden="true" tabindex="-1"></a>    team_score <span class="sc">&gt;</span> opponent_score <span class="sc">~</span> <span class="st">&quot;W&quot;</span>,</span>
<span id="cb209-26"><a href="support-vector-machines.html#cb209-26" aria-hidden="true" tabindex="-1"></a>    opponent_score <span class="sc">&gt;</span> team_score <span class="sc">~</span> <span class="st">&quot;L&quot;</span></span>
<span id="cb209-27"><a href="support-vector-machines.html#cb209-27" aria-hidden="true" tabindex="-1"></a>))) <span class="sc">%&gt;%</span> <span class="fu">na.omit</span>()</span></code></pre></div>
<pre><code>## Joining, by = c(&quot;game_id&quot;, &quot;opponent_id&quot;)</code></pre>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb211-1"><a href="support-vector-machines.html#cb211-1" aria-hidden="true" tabindex="-1"></a>games<span class="sc">$</span>TeamResult <span class="ot">&lt;-</span> <span class="fu">relevel</span>(games<span class="sc">$</span>TeamResult, <span class="at">ref=</span><span class="st">&quot;W&quot;</span>)</span>
<span id="cb211-2"><a href="support-vector-machines.html#cb211-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb211-3"><a href="support-vector-machines.html#cb211-3" aria-hidden="true" tabindex="-1"></a>rollingmodelgames <span class="ot">&lt;-</span> games <span class="sc">%&gt;%</span> <span class="fu">select</span>(game_id, game_date, team_short_display_name, opponent_short_display_name, season, team_rolling_true_shooting_percentage, team_rolling_free_throw_factor, team_rolling_turnover_percentage, team_rolling_orb, team_rolling_drb, opponent_rolling_true_shooting_percentage, opponent_rolling_free_throw_factor, opponent_rolling_turnover_percentage, opponent_rolling_orb, opponent_rolling_drb, team_dummy_home_away, TeamResult) </span>
<span id="cb211-4"><a href="support-vector-machines.html#cb211-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb211-5"><a href="support-vector-machines.html#cb211-5" aria-hidden="true" tabindex="-1"></a>cumulativemodelgames <span class="ot">&lt;-</span> games <span class="sc">%&gt;%</span> <span class="fu">select</span>(game_id, game_date, team_short_display_name, opponent_short_display_name, season, team_cumulative_mean_true_shooting, team_cumulative_mean_turnover_percentage, team_cumulative_mean_free_throw_factor, team_cumulative_mean_orb, team_cumulative_mean_drb, opponent_cumulative_mean_true_shooting, opponent_cumulative_mean_turnover_percentage, opponent_cumulative_mean_free_throw_factor, opponent_cumulative_mean_orb, opponent_cumulative_mean_drb, team_dummy_home_away, TeamResult) </span></code></pre></div>
<p>Now to split and define our recipe.</p>
<div class="sourceCode" id="cb212"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb212-1"><a href="support-vector-machines.html#cb212-1" aria-hidden="true" tabindex="-1"></a>rolling_split <span class="ot">&lt;-</span> <span class="fu">initial_split</span>(rollingmodelgames, <span class="at">prop =</span> .<span class="dv">8</span>)</span>
<span id="cb212-2"><a href="support-vector-machines.html#cb212-2" aria-hidden="true" tabindex="-1"></a>rolling_train <span class="ot">&lt;-</span> <span class="fu">training</span>(rolling_split)</span>
<span id="cb212-3"><a href="support-vector-machines.html#cb212-3" aria-hidden="true" tabindex="-1"></a>rolling_test <span class="ot">&lt;-</span> <span class="fu">testing</span>(rolling_split)</span></code></pre></div>
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb213-1"><a href="support-vector-machines.html#cb213-1" aria-hidden="true" tabindex="-1"></a>cumulative_split <span class="ot">&lt;-</span> <span class="fu">initial_split</span>(cumulativemodelgames, <span class="at">prop =</span> .<span class="dv">8</span>)</span>
<span id="cb213-2"><a href="support-vector-machines.html#cb213-2" aria-hidden="true" tabindex="-1"></a>cumulative_train <span class="ot">&lt;-</span> <span class="fu">training</span>(cumulative_split)</span>
<span id="cb213-3"><a href="support-vector-machines.html#cb213-3" aria-hidden="true" tabindex="-1"></a>cumulative_test <span class="ot">&lt;-</span> <span class="fu">testing</span>(cumulative_split)</span></code></pre></div>
<div id="recipes" class="section level2" number="9.1">
<h2><span class="header-section-number">9.1</span> Recipes</h2>
<p>Now because we’re using two different sets of predictors, we need two different recipes. We’ll need to check the summaries to make sure they only have rolling or cumulative metrics, depending.</p>
<div class="sourceCode" id="cb214"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb214-1"><a href="support-vector-machines.html#cb214-1" aria-hidden="true" tabindex="-1"></a>rolling_recipe <span class="ot">&lt;-</span> </span>
<span id="cb214-2"><a href="support-vector-machines.html#cb214-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">recipe</span>(TeamResult <span class="sc">~</span> ., <span class="at">data =</span> rolling_train) <span class="sc">%&gt;%</span> </span>
<span id="cb214-3"><a href="support-vector-machines.html#cb214-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">update_role</span>(game_id, game_date, team_short_display_name, opponent_short_display_name, season, <span class="at">new_role =</span> <span class="st">&quot;ID&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb214-4"><a href="support-vector-machines.html#cb214-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_normalize</span>(<span class="fu">all_predictors</span>())</span>
<span id="cb214-5"><a href="support-vector-machines.html#cb214-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb214-6"><a href="support-vector-machines.html#cb214-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(rolling_recipe)</span></code></pre></div>
<pre><code>## # A tibble: 17 × 4
##    variable                                  type    role      source  
##    &lt;chr&gt;                                     &lt;chr&gt;   &lt;chr&gt;     &lt;chr&gt;   
##  1 game_id                                   numeric ID        original
##  2 game_date                                 date    ID        original
##  3 team_short_display_name                   nominal ID        original
##  4 opponent_short_display_name               nominal ID        original
##  5 season                                    numeric ID        original
##  6 team_rolling_true_shooting_percentage     numeric predictor original
##  7 team_rolling_free_throw_factor            numeric predictor original
##  8 team_rolling_turnover_percentage          numeric predictor original
##  9 team_rolling_orb                          numeric predictor original
## 10 team_rolling_drb                          numeric predictor original
## 11 opponent_rolling_true_shooting_percentage numeric predictor original
## 12 opponent_rolling_free_throw_factor        numeric predictor original
## 13 opponent_rolling_turnover_percentage      numeric predictor original
## 14 opponent_rolling_orb                      numeric predictor original
## 15 opponent_rolling_drb                      numeric predictor original
## 16 team_dummy_home_away                      numeric predictor original
## 17 TeamResult                                nominal outcome   original</code></pre>
<p>Looks good. Now cumulative.</p>
<div class="sourceCode" id="cb216"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb216-1"><a href="support-vector-machines.html#cb216-1" aria-hidden="true" tabindex="-1"></a>cumulative_recipe <span class="ot">&lt;-</span> </span>
<span id="cb216-2"><a href="support-vector-machines.html#cb216-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">recipe</span>(TeamResult <span class="sc">~</span> ., <span class="at">data =</span> cumulative_train) <span class="sc">%&gt;%</span> </span>
<span id="cb216-3"><a href="support-vector-machines.html#cb216-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">update_role</span>(game_id, game_date, team_short_display_name, opponent_short_display_name, season, <span class="at">new_role =</span> <span class="st">&quot;ID&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb216-4"><a href="support-vector-machines.html#cb216-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_normalize</span>(<span class="fu">all_predictors</span>())</span>
<span id="cb216-5"><a href="support-vector-machines.html#cb216-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb216-6"><a href="support-vector-machines.html#cb216-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(cumulative_recipe)</span></code></pre></div>
<pre><code>## # A tibble: 17 × 4
##    variable                                     type    role      source  
##    &lt;chr&gt;                                        &lt;chr&gt;   &lt;chr&gt;     &lt;chr&gt;   
##  1 game_id                                      numeric ID        original
##  2 game_date                                    date    ID        original
##  3 team_short_display_name                      nominal ID        original
##  4 opponent_short_display_name                  nominal ID        original
##  5 season                                       numeric ID        original
##  6 team_cumulative_mean_true_shooting           numeric predictor original
##  7 team_cumulative_mean_turnover_percentage     numeric predictor original
##  8 team_cumulative_mean_free_throw_factor       numeric predictor original
##  9 team_cumulative_mean_orb                     numeric predictor original
## 10 team_cumulative_mean_drb                     numeric predictor original
## 11 opponent_cumulative_mean_true_shooting       numeric predictor original
## 12 opponent_cumulative_mean_turnover_percentage numeric predictor original
## 13 opponent_cumulative_mean_free_throw_factor   numeric predictor original
## 14 opponent_cumulative_mean_orb                 numeric predictor original
## 15 opponent_cumulative_mean_drb                 numeric predictor original
## 16 team_dummy_home_away                         numeric predictor original
## 17 TeamResult                                   nominal outcome   original</code></pre>
<p>And we’re good to roll.</p>
</div>
<div id="models" class="section level2" number="9.2">
<h2><span class="header-section-number">9.2</span> Models</h2>
<p>fortunately, our models are identical regardless of the recipe. The difference will come in the workflow. We’re going to produce a logisitic regression, random forest and support vector machine model here.</p>
<div class="sourceCode" id="cb218"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb218-1"><a href="support-vector-machines.html#cb218-1" aria-hidden="true" tabindex="-1"></a>log_mod <span class="ot">&lt;-</span> </span>
<span id="cb218-2"><a href="support-vector-machines.html#cb218-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">logistic_reg</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb218-3"><a href="support-vector-machines.html#cb218-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">&quot;glm&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb218-4"><a href="support-vector-machines.html#cb218-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">&quot;classification&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb219-1"><a href="support-vector-machines.html#cb219-1" aria-hidden="true" tabindex="-1"></a>rf_mod <span class="ot">&lt;-</span> <span class="fu">rand_forest</span>() <span class="sc">%&gt;%</span></span>
<span id="cb219-2"><a href="support-vector-machines.html#cb219-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">&quot;ranger&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb219-3"><a href="support-vector-machines.html#cb219-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">&quot;classification&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb220"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb220-1"><a href="support-vector-machines.html#cb220-1" aria-hidden="true" tabindex="-1"></a>svm_mod <span class="ot">&lt;-</span> </span>
<span id="cb220-2"><a href="support-vector-machines.html#cb220-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">svm_poly</span>() <span class="sc">%&gt;%</span></span>
<span id="cb220-3"><a href="support-vector-machines.html#cb220-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">&quot;kernlab&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb220-4"><a href="support-vector-machines.html#cb220-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">&quot;classification&quot;</span>) </span></code></pre></div>
</div>
<div id="workflows" class="section level2" number="9.3">
<h2><span class="header-section-number">9.3</span> Workflows</h2>
<p>Our workflows, however, will have to adjust because of different recipes. We’ll be smart and name them according to what they include.</p>
<p>First, logistic.</p>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb221-1"><a href="support-vector-machines.html#cb221-1" aria-hidden="true" tabindex="-1"></a>log_rolling_workflow <span class="ot">&lt;-</span> </span>
<span id="cb221-2"><a href="support-vector-machines.html#cb221-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">workflow</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb221-3"><a href="support-vector-machines.html#cb221-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_model</span>(log_mod) <span class="sc">%&gt;%</span> </span>
<span id="cb221-4"><a href="support-vector-machines.html#cb221-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_recipe</span>(rolling_recipe)</span></code></pre></div>
<div class="sourceCode" id="cb222"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb222-1"><a href="support-vector-machines.html#cb222-1" aria-hidden="true" tabindex="-1"></a>log_cumulative_workflow <span class="ot">&lt;-</span> </span>
<span id="cb222-2"><a href="support-vector-machines.html#cb222-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">workflow</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb222-3"><a href="support-vector-machines.html#cb222-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_model</span>(log_mod) <span class="sc">%&gt;%</span> </span>
<span id="cb222-4"><a href="support-vector-machines.html#cb222-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_recipe</span>(cumulative_recipe)</span></code></pre></div>
<p>Now random forest.</p>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb223-1"><a href="support-vector-machines.html#cb223-1" aria-hidden="true" tabindex="-1"></a>rf_rolling_workflow <span class="ot">&lt;-</span> </span>
<span id="cb223-2"><a href="support-vector-machines.html#cb223-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">workflow</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb223-3"><a href="support-vector-machines.html#cb223-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_model</span>(rf_mod) <span class="sc">%&gt;%</span> </span>
<span id="cb223-4"><a href="support-vector-machines.html#cb223-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_recipe</span>(rolling_recipe)</span></code></pre></div>
<div class="sourceCode" id="cb224"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb224-1"><a href="support-vector-machines.html#cb224-1" aria-hidden="true" tabindex="-1"></a>rf_cumulative_workflow <span class="ot">&lt;-</span> </span>
<span id="cb224-2"><a href="support-vector-machines.html#cb224-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">workflow</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb224-3"><a href="support-vector-machines.html#cb224-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_model</span>(rf_mod) <span class="sc">%&gt;%</span> </span>
<span id="cb224-4"><a href="support-vector-machines.html#cb224-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_recipe</span>(cumulative_recipe)</span></code></pre></div>
<p>And finally, support vector machine.</p>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb225-1"><a href="support-vector-machines.html#cb225-1" aria-hidden="true" tabindex="-1"></a>svm_rolling_workflow <span class="ot">&lt;-</span> </span>
<span id="cb225-2"><a href="support-vector-machines.html#cb225-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">workflow</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb225-3"><a href="support-vector-machines.html#cb225-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_model</span>(svm_mod) <span class="sc">%&gt;%</span> </span>
<span id="cb225-4"><a href="support-vector-machines.html#cb225-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_recipe</span>(rolling_recipe)</span></code></pre></div>
<div class="sourceCode" id="cb226"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb226-1"><a href="support-vector-machines.html#cb226-1" aria-hidden="true" tabindex="-1"></a>svm_cumulative_workflow <span class="ot">&lt;-</span> </span>
<span id="cb226-2"><a href="support-vector-machines.html#cb226-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">workflow</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb226-3"><a href="support-vector-machines.html#cb226-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_model</span>(svm_mod) <span class="sc">%&gt;%</span> </span>
<span id="cb226-4"><a href="support-vector-machines.html#cb226-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_recipe</span>(cumulative_recipe)</span></code></pre></div>
<p>We’ll take them one by one and compare first how each handles the different data and then compare the methods.</p>
</div>
<div id="logistic-regression-1" class="section level2" number="9.4">
<h2><span class="header-section-number">9.4</span> Logistic regression</h2>
<div class="sourceCode" id="cb227"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb227-1"><a href="support-vector-machines.html#cb227-1" aria-hidden="true" tabindex="-1"></a>log_rolling_fit <span class="ot">&lt;-</span> </span>
<span id="cb227-2"><a href="support-vector-machines.html#cb227-2" aria-hidden="true" tabindex="-1"></a>  log_rolling_workflow <span class="sc">%&gt;%</span> </span>
<span id="cb227-3"><a href="support-vector-machines.html#cb227-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(<span class="at">data =</span> rolling_train)</span>
<span id="cb227-4"><a href="support-vector-machines.html#cb227-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb227-5"><a href="support-vector-machines.html#cb227-5" aria-hidden="true" tabindex="-1"></a>logrollingpredict <span class="ot">&lt;-</span> log_rolling_fit <span class="sc">%&gt;%</span> <span class="fu">predict</span>(<span class="at">new_data =</span> rolling_train) <span class="sc">%&gt;%</span></span>
<span id="cb227-6"><a href="support-vector-machines.html#cb227-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(rolling_train) </span>
<span id="cb227-7"><a href="support-vector-machines.html#cb227-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb227-8"><a href="support-vector-machines.html#cb227-8" aria-hidden="true" tabindex="-1"></a>logrollingpredict <span class="ot">&lt;-</span> log_rolling_fit <span class="sc">%&gt;%</span> <span class="fu">predict</span>(<span class="at">new_data =</span> rolling_train, <span class="at">type=</span><span class="st">&quot;prob&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb227-9"><a href="support-vector-machines.html#cb227-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(logrollingpredict)</span>
<span id="cb227-10"><a href="support-vector-machines.html#cb227-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb227-11"><a href="support-vector-machines.html#cb227-11" aria-hidden="true" tabindex="-1"></a><span class="fu">metrics</span>(logrollingpredict, TeamResult, .pred_class)</span></code></pre></div>
<pre><code>## # A tibble: 2 × 3
##   .metric  .estimator .estimate
##   &lt;chr&gt;    &lt;chr&gt;          &lt;dbl&gt;
## 1 accuracy binary         0.663
## 2 kap      binary         0.326</code></pre>
<div class="sourceCode" id="cb229"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb229-1"><a href="support-vector-machines.html#cb229-1" aria-hidden="true" tabindex="-1"></a>log_cumulative_fit <span class="ot">&lt;-</span> </span>
<span id="cb229-2"><a href="support-vector-machines.html#cb229-2" aria-hidden="true" tabindex="-1"></a>  log_cumulative_workflow <span class="sc">%&gt;%</span> </span>
<span id="cb229-3"><a href="support-vector-machines.html#cb229-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(<span class="at">data =</span> cumulative_train)</span>
<span id="cb229-4"><a href="support-vector-machines.html#cb229-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb229-5"><a href="support-vector-machines.html#cb229-5" aria-hidden="true" tabindex="-1"></a>logcumulativepredict <span class="ot">&lt;-</span> log_cumulative_fit <span class="sc">%&gt;%</span> <span class="fu">predict</span>(<span class="at">new_data =</span> cumulative_train) <span class="sc">%&gt;%</span></span>
<span id="cb229-6"><a href="support-vector-machines.html#cb229-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(cumulative_train) </span>
<span id="cb229-7"><a href="support-vector-machines.html#cb229-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb229-8"><a href="support-vector-machines.html#cb229-8" aria-hidden="true" tabindex="-1"></a>logcumulativepredict <span class="ot">&lt;-</span> log_cumulative_fit <span class="sc">%&gt;%</span> <span class="fu">predict</span>(<span class="at">new_data =</span> cumulative_train, <span class="at">type=</span><span class="st">&quot;prob&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb229-9"><a href="support-vector-machines.html#cb229-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(logcumulativepredict)</span>
<span id="cb229-10"><a href="support-vector-machines.html#cb229-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb229-11"><a href="support-vector-machines.html#cb229-11" aria-hidden="true" tabindex="-1"></a><span class="fu">metrics</span>(logcumulativepredict, TeamResult, .pred_class)</span></code></pre></div>
<pre><code>## # A tibble: 2 × 3
##   .metric  .estimator .estimate
##   &lt;chr&gt;    &lt;chr&gt;          &lt;dbl&gt;
## 1 accuracy binary         0.666
## 2 kap      binary         0.333</code></pre>
<p>When it comes to logistic regression, the difference between the training sets is vanishingly small.</p>
<p>Now, to compare test.</p>
<div class="sourceCode" id="cb231"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb231-1"><a href="support-vector-machines.html#cb231-1" aria-hidden="true" tabindex="-1"></a>logrollingtest <span class="ot">&lt;-</span> rolling_test <span class="sc">%&gt;%</span></span>
<span id="cb231-2"><a href="support-vector-machines.html#cb231-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(<span class="fu">predict</span>(log_rolling_fit, rolling_test))</span>
<span id="cb231-3"><a href="support-vector-machines.html#cb231-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb231-4"><a href="support-vector-machines.html#cb231-4" aria-hidden="true" tabindex="-1"></a><span class="fu">metrics</span>(logrollingtest, <span class="at">truth =</span> TeamResult, <span class="at">estimate =</span> .pred_class)</span></code></pre></div>
<pre><code>## # A tibble: 2 × 3
##   .metric  .estimator .estimate
##   &lt;chr&gt;    &lt;chr&gt;          &lt;dbl&gt;
## 1 accuracy binary         0.660
## 2 kap      binary         0.320</code></pre>
<div class="sourceCode" id="cb233"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb233-1"><a href="support-vector-machines.html#cb233-1" aria-hidden="true" tabindex="-1"></a>logcumulativetest <span class="ot">&lt;-</span> cumulative_test <span class="sc">%&gt;%</span></span>
<span id="cb233-2"><a href="support-vector-machines.html#cb233-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(<span class="fu">predict</span>(log_cumulative_fit, cumulative_test))</span>
<span id="cb233-3"><a href="support-vector-machines.html#cb233-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb233-4"><a href="support-vector-machines.html#cb233-4" aria-hidden="true" tabindex="-1"></a><span class="fu">metrics</span>(logcumulativetest, <span class="at">truth =</span> TeamResult, <span class="at">estimate =</span> .pred_class)</span></code></pre></div>
<pre><code>## # A tibble: 2 × 3
##   .metric  .estimator .estimate
##   &lt;chr&gt;    &lt;chr&gt;          &lt;dbl&gt;
## 1 accuracy binary         0.670
## 2 kap      binary         0.339</code></pre>
<p>The cumulative average is fractions of a percent better, and both are stable between test and training.</p>
</div>
<div id="random-forest-1" class="section level2" number="9.5">
<h2><span class="header-section-number">9.5</span> Random forest</h2>
<div class="sourceCode" id="cb235"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb235-1"><a href="support-vector-machines.html#cb235-1" aria-hidden="true" tabindex="-1"></a>rf_rolling_fit <span class="ot">&lt;-</span> </span>
<span id="cb235-2"><a href="support-vector-machines.html#cb235-2" aria-hidden="true" tabindex="-1"></a>  rf_rolling_workflow <span class="sc">%&gt;%</span> </span>
<span id="cb235-3"><a href="support-vector-machines.html#cb235-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(<span class="at">data =</span> rolling_train)</span>
<span id="cb235-4"><a href="support-vector-machines.html#cb235-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb235-5"><a href="support-vector-machines.html#cb235-5" aria-hidden="true" tabindex="-1"></a>rfrollingpredict <span class="ot">&lt;-</span> rf_rolling_fit <span class="sc">%&gt;%</span> <span class="fu">predict</span>(<span class="at">new_data =</span> rolling_train) <span class="sc">%&gt;%</span></span>
<span id="cb235-6"><a href="support-vector-machines.html#cb235-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(rolling_train) </span>
<span id="cb235-7"><a href="support-vector-machines.html#cb235-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb235-8"><a href="support-vector-machines.html#cb235-8" aria-hidden="true" tabindex="-1"></a>rfrollingpredict <span class="ot">&lt;-</span> rf_rolling_fit <span class="sc">%&gt;%</span> <span class="fu">predict</span>(<span class="at">new_data =</span> rolling_train, <span class="at">type=</span><span class="st">&quot;prob&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb235-9"><a href="support-vector-machines.html#cb235-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(rfrollingpredict)</span>
<span id="cb235-10"><a href="support-vector-machines.html#cb235-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb235-11"><a href="support-vector-machines.html#cb235-11" aria-hidden="true" tabindex="-1"></a><span class="fu">metrics</span>(rfrollingpredict, TeamResult, .pred_class)</span></code></pre></div>
<pre><code>## # A tibble: 2 × 3
##   .metric  .estimator .estimate
##   &lt;chr&gt;    &lt;chr&gt;          &lt;dbl&gt;
## 1 accuracy binary         0.998
## 2 kap      binary         0.996</code></pre>
<div class="sourceCode" id="cb237"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb237-1"><a href="support-vector-machines.html#cb237-1" aria-hidden="true" tabindex="-1"></a>rf_cumulative_fit <span class="ot">&lt;-</span> </span>
<span id="cb237-2"><a href="support-vector-machines.html#cb237-2" aria-hidden="true" tabindex="-1"></a>  rf_cumulative_workflow <span class="sc">%&gt;%</span> </span>
<span id="cb237-3"><a href="support-vector-machines.html#cb237-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(<span class="at">data =</span> cumulative_train)</span>
<span id="cb237-4"><a href="support-vector-machines.html#cb237-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-5"><a href="support-vector-machines.html#cb237-5" aria-hidden="true" tabindex="-1"></a>rfcumulativepredict <span class="ot">&lt;-</span> rf_cumulative_fit <span class="sc">%&gt;%</span> <span class="fu">predict</span>(<span class="at">new_data =</span> cumulative_train) <span class="sc">%&gt;%</span></span>
<span id="cb237-6"><a href="support-vector-machines.html#cb237-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(cumulative_train) </span>
<span id="cb237-7"><a href="support-vector-machines.html#cb237-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-8"><a href="support-vector-machines.html#cb237-8" aria-hidden="true" tabindex="-1"></a>rfcumulativepredict <span class="ot">&lt;-</span> rf_cumulative_fit <span class="sc">%&gt;%</span> <span class="fu">predict</span>(<span class="at">new_data =</span> cumulative_train, <span class="at">type=</span><span class="st">&quot;prob&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb237-9"><a href="support-vector-machines.html#cb237-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(rfcumulativepredict)</span>
<span id="cb237-10"><a href="support-vector-machines.html#cb237-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-11"><a href="support-vector-machines.html#cb237-11" aria-hidden="true" tabindex="-1"></a><span class="fu">metrics</span>(rfcumulativepredict, TeamResult, .pred_class)</span></code></pre></div>
<pre><code>## # A tibble: 2 × 3
##   .metric  .estimator .estimate
##   &lt;chr&gt;    &lt;chr&gt;          &lt;dbl&gt;
## 1 accuracy binary         0.997
## 2 kap      binary         0.994</code></pre>
<p>But we all know we can’t take a random forest training metrics seriously, so here’s test.</p>
<div class="sourceCode" id="cb239"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb239-1"><a href="support-vector-machines.html#cb239-1" aria-hidden="true" tabindex="-1"></a>rfrollingtestresults <span class="ot">&lt;-</span> rolling_test <span class="sc">%&gt;%</span></span>
<span id="cb239-2"><a href="support-vector-machines.html#cb239-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(<span class="fu">predict</span>(rf_rolling_fit, rolling_test))</span>
<span id="cb239-3"><a href="support-vector-machines.html#cb239-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb239-4"><a href="support-vector-machines.html#cb239-4" aria-hidden="true" tabindex="-1"></a><span class="fu">metrics</span>(rfrollingtestresults, <span class="at">truth =</span> TeamResult, <span class="at">estimate =</span> .pred_class)</span></code></pre></div>
<pre><code>## # A tibble: 2 × 3
##   .metric  .estimator .estimate
##   &lt;chr&gt;    &lt;chr&gt;          &lt;dbl&gt;
## 1 accuracy binary         0.651
## 2 kap      binary         0.303</code></pre>
<div class="sourceCode" id="cb241"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb241-1"><a href="support-vector-machines.html#cb241-1" aria-hidden="true" tabindex="-1"></a>rfcumulativetestresults <span class="ot">&lt;-</span> cumulative_test <span class="sc">%&gt;%</span></span>
<span id="cb241-2"><a href="support-vector-machines.html#cb241-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(<span class="fu">predict</span>(rf_cumulative_fit, cumulative_test))</span>
<span id="cb241-3"><a href="support-vector-machines.html#cb241-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb241-4"><a href="support-vector-machines.html#cb241-4" aria-hidden="true" tabindex="-1"></a><span class="fu">metrics</span>(rfcumulativetestresults, <span class="at">truth =</span> TeamResult, <span class="at">estimate =</span> .pred_class)</span></code></pre></div>
<pre><code>## # A tibble: 2 × 3
##   .metric  .estimator .estimate
##   &lt;chr&gt;    &lt;chr&gt;          &lt;dbl&gt;
## 1 accuracy binary         0.653
## 2 kap      binary         0.307</code></pre>
<p>Again, a very narrow difference between rolling and cumulative, and slightly worse performance against the logistic regression.</p>
</div>
<div id="support-vector-machine" class="section level2" number="9.6">
<h2><span class="header-section-number">9.6</span> Support Vector Machine</h2>
<p>The inputs of the support vector machine are very similar to others. There are parameters you can tune, but similar to XGBoost, this can take time and in my experience doesn’t result in major improvements. The defaults work well enough for us. We can just jump right into the fit.</p>
<div class="sourceCode" id="cb243"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb243-1"><a href="support-vector-machines.html#cb243-1" aria-hidden="true" tabindex="-1"></a>svm_rolling_fit <span class="ot">&lt;-</span> </span>
<span id="cb243-2"><a href="support-vector-machines.html#cb243-2" aria-hidden="true" tabindex="-1"></a>  svm_rolling_workflow <span class="sc">%&gt;%</span> </span>
<span id="cb243-3"><a href="support-vector-machines.html#cb243-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(<span class="at">data =</span> rolling_train)</span></code></pre></div>
<pre><code>##  Setting default kernel parameters</code></pre>
<div class="sourceCode" id="cb245"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb245-1"><a href="support-vector-machines.html#cb245-1" aria-hidden="true" tabindex="-1"></a>svmrollingtrainresults <span class="ot">&lt;-</span> rolling_train <span class="sc">%&gt;%</span></span>
<span id="cb245-2"><a href="support-vector-machines.html#cb245-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(<span class="fu">predict</span>(svm_rolling_fit, rolling_train))</span></code></pre></div>
<div class="sourceCode" id="cb246"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb246-1"><a href="support-vector-machines.html#cb246-1" aria-hidden="true" tabindex="-1"></a><span class="fu">metrics</span>(svmrollingtrainresults, <span class="at">truth =</span> TeamResult, <span class="at">estimate =</span> .pred_class)</span></code></pre></div>
<pre><code>## # A tibble: 2 × 3
##   .metric  .estimator .estimate
##   &lt;chr&gt;    &lt;chr&gt;          &lt;dbl&gt;
## 1 accuracy binary         0.661
## 2 kap      binary         0.321</code></pre>
<div class="sourceCode" id="cb248"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb248-1"><a href="support-vector-machines.html#cb248-1" aria-hidden="true" tabindex="-1"></a>svm_cumulative_fit <span class="ot">&lt;-</span> </span>
<span id="cb248-2"><a href="support-vector-machines.html#cb248-2" aria-hidden="true" tabindex="-1"></a>  svm_cumulative_workflow <span class="sc">%&gt;%</span> </span>
<span id="cb248-3"><a href="support-vector-machines.html#cb248-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(<span class="at">data =</span> cumulative_train)</span></code></pre></div>
<pre><code>##  Setting default kernel parameters</code></pre>
<div class="sourceCode" id="cb250"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb250-1"><a href="support-vector-machines.html#cb250-1" aria-hidden="true" tabindex="-1"></a>svmcumulativetrainresults <span class="ot">&lt;-</span> cumulative_train <span class="sc">%&gt;%</span></span>
<span id="cb250-2"><a href="support-vector-machines.html#cb250-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(<span class="fu">predict</span>(svm_cumulative_fit, cumulative_train))</span>
<span id="cb250-3"><a href="support-vector-machines.html#cb250-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb250-4"><a href="support-vector-machines.html#cb250-4" aria-hidden="true" tabindex="-1"></a><span class="fu">metrics</span>(svmcumulativetrainresults, <span class="at">truth =</span> TeamResult, <span class="at">estimate =</span> .pred_class)</span></code></pre></div>
<pre><code>## # A tibble: 2 × 3
##   .metric  .estimator .estimate
##   &lt;chr&gt;    &lt;chr&gt;          &lt;dbl&gt;
## 1 accuracy binary         0.660
## 2 kap      binary         0.320</code></pre>
<p>And now testing.</p>
<div class="sourceCode" id="cb252"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb252-1"><a href="support-vector-machines.html#cb252-1" aria-hidden="true" tabindex="-1"></a>svmrollingtestresults <span class="ot">&lt;-</span> rolling_test <span class="sc">%&gt;%</span></span>
<span id="cb252-2"><a href="support-vector-machines.html#cb252-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(<span class="fu">predict</span>(svm_rolling_fit, rolling_test))</span>
<span id="cb252-3"><a href="support-vector-machines.html#cb252-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb252-4"><a href="support-vector-machines.html#cb252-4" aria-hidden="true" tabindex="-1"></a><span class="fu">metrics</span>(svmrollingtestresults, <span class="at">truth =</span> TeamResult, <span class="at">estimate =</span> .pred_class)</span></code></pre></div>
<pre><code>## # A tibble: 2 × 3
##   .metric  .estimator .estimate
##   &lt;chr&gt;    &lt;chr&gt;          &lt;dbl&gt;
## 1 accuracy binary         0.659
## 2 kap      binary         0.317</code></pre>
<div class="sourceCode" id="cb254"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb254-1"><a href="support-vector-machines.html#cb254-1" aria-hidden="true" tabindex="-1"></a>svmcumulativetestresults <span class="ot">&lt;-</span> cumulative_test <span class="sc">%&gt;%</span></span>
<span id="cb254-2"><a href="support-vector-machines.html#cb254-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(<span class="fu">predict</span>(svm_cumulative_fit, cumulative_test))</span>
<span id="cb254-3"><a href="support-vector-machines.html#cb254-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb254-4"><a href="support-vector-machines.html#cb254-4" aria-hidden="true" tabindex="-1"></a><span class="fu">metrics</span>(svmcumulativetestresults, <span class="at">truth =</span> TeamResult, <span class="at">estimate =</span> .pred_class)</span></code></pre></div>
<pre><code>## # A tibble: 2 × 3
##   .metric  .estimator .estimate
##   &lt;chr&gt;    &lt;chr&gt;          &lt;dbl&gt;
## 1 accuracy binary         0.662
## 2 kap      binary         0.324</code></pre>
</div>
<div id="bottom-line" class="section level2" number="9.7">
<h2><span class="header-section-number">9.7</span> Bottom line</h2>
<p>After all this, all this work to compare methods, all this work to create both sides of Dean Oliver’s Four Factors and incorporate them into a model, we’ve come to the conclusion that we’re able to predict 2 of every 3 games. Good? It’s decent. Could we do better? I would hope. Others have.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="xgboost-to-make-classifications.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/08-svm.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["advancedsportsdataanalysis.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
