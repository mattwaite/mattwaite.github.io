<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 6 Logistic Regression | Advanced Sports Data Analysis</title>
  <meta name="description" content="This is the companion text to the University of Nebraska-Lincoln’s SPMC 460: Advanced Sports Data Analysis" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 6 Logistic Regression | Advanced Sports Data Analysis" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is the companion text to the University of Nebraska-Lincoln’s SPMC 460: Advanced Sports Data Analysis" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 6 Logistic Regression | Advanced Sports Data Analysis" />
  
  <meta name="twitter:description" content="This is the companion text to the University of Nebraska-Lincoln’s SPMC 460: Advanced Sports Data Analysis" />
  

<meta name="author" content="By Matt Waite" />


<meta name="date" content="2021-03-04" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="xgboost.html"/>

<script src="libs/header-attrs-2.5/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Advanced Sports Data Analysis</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#requirements-and-conventions"><i class="fa fa-check"></i><b>1.1</b> Requirements and Conventions</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#about-this-book"><i class="fa fa-check"></i><b>1.2</b> About this book</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="the-modeling-process.html"><a href="the-modeling-process.html"><i class="fa fa-check"></i><b>2</b> The modeling process</a>
<ul>
<li class="chapter" data-level="2.1" data-path="the-modeling-process.html"><a href="the-modeling-process.html#setting-up-the-modeling-process"><i class="fa fa-check"></i><b>2.1</b> Setting up the modeling process</a></li>
<li class="chapter" data-level="2.2" data-path="the-modeling-process.html"><a href="the-modeling-process.html#predicting-based-on-the-model"><i class="fa fa-check"></i><b>2.2</b> Predicting based on the model</a></li>
<li class="chapter" data-level="2.3" data-path="the-modeling-process.html"><a href="the-modeling-process.html#predicting-data-we-havent-seen-before"><i class="fa fa-check"></i><b>2.3</b> Predicting data we haven’t seen before</a></li>
<li class="chapter" data-level="2.4" data-path="the-modeling-process.html"><a href="the-modeling-process.html#looking-locally"><i class="fa fa-check"></i><b>2.4</b> Looking locally</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="multiple-regression-and-feature-engineering.html"><a href="multiple-regression-and-feature-engineering.html"><i class="fa fa-check"></i><b>3</b> Multiple regression and feature engineering</a>
<ul>
<li class="chapter" data-level="3.1" data-path="multiple-regression-and-feature-engineering.html"><a href="multiple-regression-and-feature-engineering.html#a-multiple-regression-speed-run"><i class="fa fa-check"></i><b>3.1</b> A multiple regression speed run</a></li>
<li class="chapter" data-level="3.2" data-path="multiple-regression-and-feature-engineering.html"><a href="multiple-regression-and-feature-engineering.html#picking-what-moves-the-needle"><i class="fa fa-check"></i><b>3.2</b> Picking what moves the needle</a></li>
<li class="chapter" data-level="3.3" data-path="multiple-regression-and-feature-engineering.html"><a href="multiple-regression-and-feature-engineering.html#feature-engineering"><i class="fa fa-check"></i><b>3.3</b> Feature engineering</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="decision-trees-and-random-forests.html"><a href="decision-trees-and-random-forests.html"><i class="fa fa-check"></i><b>4</b> Decision trees and random forests</a>
<ul>
<li class="chapter" data-level="4.1" data-path="decision-trees-and-random-forests.html"><a href="decision-trees-and-random-forests.html#an-intro-to-pre-processing"><i class="fa fa-check"></i><b>4.1</b> An intro to pre-processing</a></li>
<li class="chapter" data-level="4.2" data-path="decision-trees-and-random-forests.html"><a href="decision-trees-and-random-forests.html#decision-trees"><i class="fa fa-check"></i><b>4.2</b> Decision trees</a></li>
<li class="chapter" data-level="4.3" data-path="decision-trees-and-random-forests.html"><a href="decision-trees-and-random-forests.html#random-forest"><i class="fa fa-check"></i><b>4.3</b> Random forest</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="xgboost.html"><a href="xgboost.html"><i class="fa fa-check"></i><b>5</b> XGBoost</a>
<ul>
<li class="chapter" data-level="5.1" data-path="xgboost.html"><a href="xgboost.html#hyperparameters"><i class="fa fa-check"></i><b>5.1</b> Hyperparameters</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="logistic-regression.html"><a href="logistic-regression.html"><i class="fa fa-check"></i><b>6</b> Logistic Regression</a>
<ul>
<li class="chapter" data-level="6.1" data-path="logistic-regression.html"><a href="logistic-regression.html#visualizing-the-decision-boundary"><i class="fa fa-check"></i><b>6.1</b> Visualizing the decision boundary</a></li>
<li class="chapter" data-level="6.2" data-path="logistic-regression.html"><a href="logistic-regression.html#the-logistic-regression"><i class="fa fa-check"></i><b>6.2</b> The logistic regression</a></li>
<li class="chapter" data-level="6.3" data-path="logistic-regression.html"><a href="logistic-regression.html#evaluating-the-fit"><i class="fa fa-check"></i><b>6.3</b> Evaluating the fit</a></li>
<li class="chapter" data-level="6.4" data-path="logistic-regression.html"><a href="logistic-regression.html#comparing-it-to-test-data"><i class="fa fa-check"></i><b>6.4</b> Comparing it to test data</a></li>
<li class="chapter" data-level="6.5" data-path="logistic-regression.html"><a href="logistic-regression.html#how-well-did-it-do-with-nebraska"><i class="fa fa-check"></i><b>6.5</b> How well did it do with Nebraska?</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Advanced Sports Data Analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="logistic-regression" class="section level1" number="6">
<h1><span class="header-section-number">Chapter 6</span> Logistic Regression</h1>
<p>Up to this point, we’ve been dealing with problems that lead to a <em>quantitative</em> answer: We want a number. How many points? How many possessions? But there are lots of problems in the world where the answer is <em>qualitative</em>: Did they win or lose? Did the player get drafted or no? Is this player a flight risk to transfer or not?</p>
<p>These are problems of classification and they use many of the same algorithms we’ve used to try and predict those classes.</p>
<p>Ultimately, the algorithms will predict the <em>probability</em> that this row is X or Y and make a decision based on that probability. That probability will be somewhere between 0 and 1, with 0 being no chance and 1 being a sure thing.</p>
<p>Where this gets interesting is in the middle.</p>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="logistic-regression.html#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb151-2"><a href="logistic-regression.html#cb151-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidymodels)</span>
<span id="cb151-3"><a href="logistic-regression.html#cb151-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-4"><a href="logistic-regression.html#cb151-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span></code></pre></div>
<p>What we’re going to do here is calculate possessions in the game, the team’s Points Per Possession and then some cumulative means for those two things. Then we’ll do a little cleanup on it being a home or an away game and we’ll clean up the win/loss column to be simple W or L.</p>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="logistic-regression.html#cb152-1" aria-hidden="true" tabindex="-1"></a>games <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/cbblogs1521.csv&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb152-2"><a href="logistic-regression.html#cb152-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">Possessions =</span> .<span class="dv">5</span><span class="sc">*</span>(TeamFGA <span class="sc">-</span> TeamOffRebounds <span class="sc">+</span> TeamTurnovers <span class="sc">+</span> (.<span class="dv">475</span> <span class="sc">*</span> TeamFTA)) <span class="sc">+</span> .<span class="dv">5</span><span class="sc">*</span>(OpponentFGA <span class="sc">-</span> OpponentOffRebounds <span class="sc">+</span> OpponentTurnovers <span class="sc">+</span> (.<span class="dv">475</span> <span class="sc">*</span> OpponentFTA)),</span>
<span id="cb152-3"><a href="logistic-regression.html#cb152-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">PPP =</span> TeamScore<span class="sc">/</span>Possessions) <span class="sc">%&gt;%</span></span>
<span id="cb152-4"><a href="logistic-regression.html#cb152-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Team, Season) <span class="sc">%&gt;%</span></span>
<span id="cb152-5"><a href="logistic-regression.html#cb152-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb152-6"><a href="logistic-regression.html#cb152-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Cumulative_Mean_Possessions =</span> <span class="fu">cummean</span>(Possessions),</span>
<span id="cb152-7"><a href="logistic-regression.html#cb152-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">Cumulative_Mean_PPP =</span> <span class="fu">cummean</span>(PPP)</span>
<span id="cb152-8"><a href="logistic-regression.html#cb152-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb152-9"><a href="logistic-regression.html#cb152-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb152-10"><a href="logistic-regression.html#cb152-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">Location =</span> <span class="fu">case_when</span>(</span>
<span id="cb152-11"><a href="logistic-regression.html#cb152-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_trim</span>(HomeAway) <span class="sc">==</span> <span class="st">&quot;@&quot;</span> <span class="sc">~</span> <span class="st">&quot;A&quot;</span>,</span>
<span id="cb152-12"><a href="logistic-regression.html#cb152-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">str_trim</span>(HomeAway) <span class="sc">==</span> <span class="st">&quot;N&quot;</span> <span class="sc">~</span> <span class="st">&quot;N&quot;</span>,</span>
<span id="cb152-13"><a href="logistic-regression.html#cb152-13" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">&quot;H&quot;</span></span>
<span id="cb152-14"><a href="logistic-regression.html#cb152-14" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb152-15"><a href="logistic-regression.html#cb152-15" aria-hidden="true" tabindex="-1"></a> <span class="at">Outcome =</span> <span class="fu">case_when</span>(</span>
<span id="cb152-16"><a href="logistic-regression.html#cb152-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">grepl</span>(<span class="st">&quot;W&quot;</span>, W_L) <span class="sc">~</span> <span class="st">&quot;W&quot;</span>, </span>
<span id="cb152-17"><a href="logistic-regression.html#cb152-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">grepl</span>(<span class="st">&quot;L&quot;</span>, W_L) <span class="sc">~</span> <span class="st">&quot;L&quot;</span></span>
<span id="cb152-18"><a href="logistic-regression.html#cb152-18" aria-hidden="true" tabindex="-1"></a> )</span>
<span id="cb152-19"><a href="logistic-regression.html#cb152-19" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb152-20"><a href="logistic-regression.html#cb152-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Outcome =</span> <span class="fu">as.factor</span>(Outcome))</span></code></pre></div>
<pre><code>## 
## ── Column specification ────────────────────────────────────────────────────────
## cols(
##   .default = col_double(),
##   Season = col_character(),
##   Date = col_date(format = &quot;&quot;),
##   TeamFull = col_character(),
##   Opponent = col_character(),
##   HomeAway = col_character(),
##   W_L = col_character(),
##   URL = col_character(),
##   Conference = col_character(),
##   Team = col_character()
## )
## ℹ Use `spec()` for the full column specifications.</code></pre>
<p>Now we’ll use select to get us the fields we need.</p>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="logistic-regression.html#cb154-1" aria-hidden="true" tabindex="-1"></a>selectedgames <span class="ot">&lt;-</span> games <span class="sc">%&gt;%</span> <span class="fu">select</span>(Season, Team, Date, Opponent, Location, Outcome, Cumulative_Mean_Possessions, Cumulative_Mean_PPP, TeamSRS)</span></code></pre></div>
<p>Now what we’ll do is create the reverse side of the game by just renaming things to Opponent_X. That way, we can join them together and create the whole picture of the game – team and opponent. We’ll lose some games, but those will be against Division II opponents and we won’t care.</p>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="logistic-regression.html#cb155-1" aria-hidden="true" tabindex="-1"></a>opponentgames <span class="ot">&lt;-</span> selectedgames <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="at">Opponent_Cumulative_Mean_Possessions =</span> Cumulative_Mean_Possessions, <span class="at">Opponent_Cumulative_Mean_PPP =</span> Cumulative_Mean_PPP, <span class="at">OpponentSRS =</span> TeamSRS)</span></code></pre></div>
<p>Now the join. This works because the Team field in opponent games is the Opponent field in selectedgames. The date of the game and the seson are identical in both sides of the game, so it ensures we’re combining data for the same, correct game.</p>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="logistic-regression.html#cb156-1" aria-hidden="true" tabindex="-1"></a>bothsides <span class="ot">&lt;-</span> selectedgames <span class="sc">%&gt;%</span> <span class="fu">left_join</span>(opponentgames, <span class="at">by=</span><span class="fu">c</span>(<span class="st">&quot;Team&quot;</span> <span class="ot">=</span> <span class="st">&quot;Opponent&quot;</span>, <span class="st">&quot;Date&quot;</span>, <span class="st">&quot;Season&quot;</span>)) <span class="sc">%&gt;%</span> <span class="fu">na.omit</span>() <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>Team.y, <span class="sc">-</span>Location.y, <span class="sc">-</span>Outcome.y) <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="at">Location =</span> Location.x, <span class="at">Outcome =</span> Outcome.x)</span></code></pre></div>
<div id="visualizing-the-decision-boundary" class="section level2" number="6.1">
<h2><span class="header-section-number">6.1</span> Visualizing the decision boundary</h2>
<p>This is just one dimension of the data, but it can illustrate how this works. You can see a line running through the middle, with a lot of overlap. The further left or right you go, the less overlap. That neatly captures the probabilities we’re looking at here.</p>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="logistic-regression.html#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">data=</span>bothsides, <span class="fu">aes</span>(<span class="at">x=</span>Cumulative_Mean_PPP, <span class="at">y=</span>Opponent_Cumulative_Mean_PPP, <span class="at">color=</span>Outcome))</span></code></pre></div>
<p><img src="advancedsportsdataanalysis_files/figure-html/unnamed-chunk-98-1.png" width="672" /></p>
</div>
<div id="the-logistic-regression" class="section level2" number="6.2">
<h2><span class="header-section-number">6.2</span> The logistic regression</h2>
<p>Much of implementing classification algorithms should look familiar by now. The steps we’ve been using are steps we will use again. First, we split into training and testing.</p>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="logistic-regression.html#cb158-1" aria-hidden="true" tabindex="-1"></a>log_split <span class="ot">&lt;-</span> <span class="fu">initial_split</span>(bothsides, <span class="at">prop =</span> .<span class="dv">8</span>)</span>
<span id="cb158-2"><a href="logistic-regression.html#cb158-2" aria-hidden="true" tabindex="-1"></a>log_train <span class="ot">&lt;-</span> <span class="fu">training</span>(log_split)</span>
<span id="cb158-3"><a href="logistic-regression.html#cb158-3" aria-hidden="true" tabindex="-1"></a>log_test <span class="ot">&lt;-</span> <span class="fu">testing</span>(log_split)</span></code></pre></div>
<p>We create a recipe. In this case, we need to create dummy values for home and away games. Our recipe will put a 1 for home and a 0 for away, for example. We’re also going to normalize our predictors so scale differences don’t create undue influences.</p>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="logistic-regression.html#cb159-1" aria-hidden="true" tabindex="-1"></a>log_recipe <span class="ot">&lt;-</span> </span>
<span id="cb159-2"><a href="logistic-regression.html#cb159-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">recipe</span>(Outcome <span class="sc">~</span> ., <span class="at">data =</span> log_train) <span class="sc">%&gt;%</span> </span>
<span id="cb159-3"><a href="logistic-regression.html#cb159-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">update_role</span>(Team, Opponent, Date, Season, <span class="at">new_role =</span> <span class="st">&quot;ID&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb159-4"><a href="logistic-regression.html#cb159-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_dummy</span>(<span class="fu">all_nominal</span>(), <span class="sc">-</span><span class="fu">all_outcomes</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb159-5"><a href="logistic-regression.html#cb159-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_normalize</span>(<span class="fu">all_predictors</span>())</span>
<span id="cb159-6"><a href="logistic-regression.html#cb159-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-7"><a href="logistic-regression.html#cb159-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(log_recipe)</span></code></pre></div>
<pre><code>## # A tibble: 12 x 4
##    variable                             type    role      source  
##    &lt;chr&gt;                                &lt;chr&gt;   &lt;chr&gt;     &lt;chr&gt;   
##  1 Season                               nominal ID        original
##  2 Team                                 nominal ID        original
##  3 Date                                 date    ID        original
##  4 Opponent                             nominal ID        original
##  5 Location                             nominal predictor original
##  6 Cumulative_Mean_Possessions          numeric predictor original
##  7 Cumulative_Mean_PPP                  numeric predictor original
##  8 TeamSRS                              numeric predictor original
##  9 Opponent_Cumulative_Mean_Possessions numeric predictor original
## 10 Opponent_Cumulative_Mean_PPP         numeric predictor original
## 11 OpponentSRS                          numeric predictor original
## 12 Outcome                              nominal outcome   original</code></pre>
<p>Now we define the model. Note the set_mode.</p>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="logistic-regression.html#cb161-1" aria-hidden="true" tabindex="-1"></a>log_mod <span class="ot">&lt;-</span> </span>
<span id="cb161-2"><a href="logistic-regression.html#cb161-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">logistic_reg</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb161-3"><a href="logistic-regression.html#cb161-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">&quot;glm&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb161-4"><a href="logistic-regression.html#cb161-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">&quot;classification&quot;</span>)</span></code></pre></div>
<p>Now we have enough for a workflow.</p>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="logistic-regression.html#cb162-1" aria-hidden="true" tabindex="-1"></a>log_workflow <span class="ot">&lt;-</span> </span>
<span id="cb162-2"><a href="logistic-regression.html#cb162-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">workflow</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb162-3"><a href="logistic-regression.html#cb162-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_model</span>(log_mod) <span class="sc">%&gt;%</span> </span>
<span id="cb162-4"><a href="logistic-regression.html#cb162-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_recipe</span>(log_recipe)</span></code></pre></div>
<p>And now we fit our model (this can take a few minutes).</p>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="logistic-regression.html#cb163-1" aria-hidden="true" tabindex="-1"></a>log_fit <span class="ot">&lt;-</span> </span>
<span id="cb163-2"><a href="logistic-regression.html#cb163-2" aria-hidden="true" tabindex="-1"></a>  log_workflow <span class="sc">%&gt;%</span> </span>
<span id="cb163-3"><a href="logistic-regression.html#cb163-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(<span class="at">data =</span> log_train)</span></code></pre></div>
</div>
<div id="evaluating-the-fit" class="section level2" number="6.3">
<h2><span class="header-section-number">6.3</span> Evaluating the fit</h2>
<p>With logisitic regression, there’s two things we’re looking at: The prediction and the probabilities. We can get those with two different fits and combine them together.</p>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="logistic-regression.html#cb164-1" aria-hidden="true" tabindex="-1"></a>trainpredict <span class="ot">&lt;-</span> log_fit <span class="sc">%&gt;%</span> <span class="fu">predict</span>(<span class="at">new_data =</span> log_train) <span class="sc">%&gt;%</span></span>
<span id="cb164-2"><a href="logistic-regression.html#cb164-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(log_train)</span>
<span id="cb164-3"><a href="logistic-regression.html#cb164-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-4"><a href="logistic-regression.html#cb164-4" aria-hidden="true" tabindex="-1"></a>trainpredict</span></code></pre></div>
<pre><code>## # A tibble: 38,058 x 13
##    .pred_class Season Team  Date       Opponent Location Outcome
##    &lt;fct&gt;       &lt;chr&gt;  &lt;chr&gt; &lt;date&gt;     &lt;chr&gt;    &lt;chr&gt;    &lt;fct&gt;  
##  1 L           2014-… Abil… 2014-11-19 Tulsa    A        L      
##  2 L           2014-… Abil… 2014-11-22 Duquesne H        L      
##  3 L           2014-… Abil… 2014-11-29 UC-Rive… A        L      
##  4 L           2014-… Abil… 2014-12-04 Sacrame… H        W      
##  5 L           2014-… Abil… 2014-12-06 Houston  A        L      
##  6 L           2014-… Abil… 2014-12-17 Loyola … A        L      
##  7 L           2014-… Abil… 2014-12-23 Arkansa… N        W      
##  8 L           2014-… Abil… 2014-12-28 Grand C… A        L      
##  9 W           2014-… Abil… 2015-01-04 Central… H        W      
## 10 W           2014-… Abil… 2015-01-10 Nicholl… H        W      
## # … with 38,048 more rows, and 6 more variables:
## #   Cumulative_Mean_Possessions &lt;dbl&gt;, Cumulative_Mean_PPP &lt;dbl&gt;,
## #   TeamSRS &lt;dbl&gt;, Opponent_Cumulative_Mean_Possessions &lt;dbl&gt;,
## #   Opponent_Cumulative_Mean_PPP &lt;dbl&gt;, OpponentSRS &lt;dbl&gt;</code></pre>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="logistic-regression.html#cb166-1" aria-hidden="true" tabindex="-1"></a>trainpredict <span class="ot">&lt;-</span> log_fit <span class="sc">%&gt;%</span> <span class="fu">predict</span>(<span class="at">new_data =</span> log_train, <span class="at">type=</span><span class="st">&quot;prob&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb166-2"><a href="logistic-regression.html#cb166-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(trainpredict)</span>
<span id="cb166-3"><a href="logistic-regression.html#cb166-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-4"><a href="logistic-regression.html#cb166-4" aria-hidden="true" tabindex="-1"></a>trainpredict</span></code></pre></div>
<pre><code>## # A tibble: 38,058 x 15
##    .pred_L .pred_W .pred_class Season Team  Date       Opponent Location Outcome
##      &lt;dbl&gt;   &lt;dbl&gt; &lt;fct&gt;       &lt;chr&gt;  &lt;chr&gt; &lt;date&gt;     &lt;chr&gt;    &lt;chr&gt;    &lt;fct&gt;  
##  1   0.981  0.0187 L           2014-… Abil… 2014-11-19 Tulsa    A        L      
##  2   0.954  0.0463 L           2014-… Abil… 2014-11-22 Duquesne H        L      
##  3   0.918  0.0817 L           2014-… Abil… 2014-11-29 UC-Rive… A        L      
##  4   0.818  0.182  L           2014-… Abil… 2014-12-04 Sacrame… H        W      
##  5   0.839  0.161  L           2014-… Abil… 2014-12-06 Houston  A        L      
##  6   0.969  0.0310 L           2014-… Abil… 2014-12-17 Loyola … A        L      
##  7   0.553  0.447  L           2014-… Abil… 2014-12-23 Arkansa… N        W      
##  8   0.899  0.101  L           2014-… Abil… 2014-12-28 Grand C… A        L      
##  9   0.132  0.868  W           2014-… Abil… 2015-01-04 Central… H        W      
## 10   0.365  0.635  W           2014-… Abil… 2015-01-10 Nicholl… H        W      
## # … with 38,048 more rows, and 6 more variables:
## #   Cumulative_Mean_Possessions &lt;dbl&gt;, Cumulative_Mean_PPP &lt;dbl&gt;,
## #   TeamSRS &lt;dbl&gt;, Opponent_Cumulative_Mean_Possessions &lt;dbl&gt;,
## #   Opponent_Cumulative_Mean_PPP &lt;dbl&gt;, OpponentSRS &lt;dbl&gt;</code></pre>
<p>There’s several metrics to look at, but the two we will use are accuracy and roc_auc. They both are pointing toward how well the model did in two different ways. The accuracy metric looks at the number of predictions that are correct when compared to known results.</p>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="logistic-regression.html#cb168-1" aria-hidden="true" tabindex="-1"></a><span class="fu">metrics</span>(trainpredict, Outcome, .pred_class)</span></code></pre></div>
<pre><code>## # A tibble: 2 x 3
##   .metric  .estimator .estimate
##   &lt;chr&gt;    &lt;chr&gt;          &lt;dbl&gt;
## 1 accuracy binary         0.761
## 2 kap      binary         0.522</code></pre>
<p>Another way to look at that is the confusion matrix. The confusion matrix shows what was predicted compared to what actually happened. The squares are True Positives, False Positives, True Negatives and False Negatives. True values vs the total values make up the accuracy.</p>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="logistic-regression.html#cb170-1" aria-hidden="true" tabindex="-1"></a>trainpredict <span class="sc">%&gt;%</span></span>
<span id="cb170-2"><a href="logistic-regression.html#cb170-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">conf_mat</span>(Outcome, .pred_class)</span></code></pre></div>
<pre><code>##           Truth
## Prediction     L     W
##          L 14517  4567
##          W  4530 14444</code></pre>
<p>The roc_auc metric is largely a graphical representation of how well the classifier did. The higher the roc_auc, the better, but too high and you’ve likely overfit the data.</p>
<p>We can look at the roc_auc metric for both sides of our prediction. In this case, our model is not great on Wins.</p>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="logistic-regression.html#cb172-1" aria-hidden="true" tabindex="-1"></a><span class="fu">roc_auc</span>(trainpredict, <span class="at">truth =</span> Outcome, .pred_W)</span></code></pre></div>
<pre><code>## # A tibble: 1 x 3
##   .metric .estimator .estimate
##   &lt;chr&gt;   &lt;chr&gt;          &lt;dbl&gt;
## 1 roc_auc binary         0.156</code></pre>
<p>But is quite confident on Loses.</p>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="logistic-regression.html#cb174-1" aria-hidden="true" tabindex="-1"></a><span class="fu">roc_auc</span>(trainpredict, <span class="at">truth =</span> Outcome, .pred_L)</span></code></pre></div>
<pre><code>## # A tibble: 1 x 3
##   .metric .estimator .estimate
##   &lt;chr&gt;   &lt;chr&gt;          &lt;dbl&gt;
## 1 roc_auc binary         0.844</code></pre>
<p>The advantage of the roc_auc curve is that you can visualize it.</p>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="logistic-regression.html#cb176-1" aria-hidden="true" tabindex="-1"></a>roc_data <span class="ot">&lt;-</span> <span class="fu">roc_curve</span>(trainpredict, <span class="at">truth =</span> Outcome, .pred_L) </span>
<span id="cb176-2"><a href="logistic-regression.html#cb176-2" aria-hidden="true" tabindex="-1"></a>roc_data <span class="sc">%&gt;%</span>  </span>
<span id="cb176-3"><a href="logistic-regression.html#cb176-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">1</span> <span class="sc">-</span> specificity, <span class="at">y =</span> sensitivity)) <span class="sc">+</span></span>
<span id="cb176-4"><a href="logistic-regression.html#cb176-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>() <span class="sc">+</span></span>
<span id="cb176-5"><a href="logistic-regression.html#cb176-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">lty =</span> <span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb176-6"><a href="logistic-regression.html#cb176-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_equal</span>()</span></code></pre></div>
<p><img src="advancedsportsdataanalysis_files/figure-html/unnamed-chunk-110-1.png" width="672" /></p>
</div>
<div id="comparing-it-to-test-data" class="section level2" number="6.4">
<h2><span class="header-section-number">6.4</span> Comparing it to test data</h2>
<p>Now we can apply our fit to the test data to see how robust it is. Short version: Pretty good. Our numbers don’t dip all that much.</p>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="logistic-regression.html#cb177-1" aria-hidden="true" tabindex="-1"></a>testpredict <span class="ot">&lt;-</span> log_fit <span class="sc">%&gt;%</span> <span class="fu">predict</span>(<span class="at">new_data =</span> log_test) <span class="sc">%&gt;%</span></span>
<span id="cb177-2"><a href="logistic-regression.html#cb177-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(log_test)</span>
<span id="cb177-3"><a href="logistic-regression.html#cb177-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb177-4"><a href="logistic-regression.html#cb177-4" aria-hidden="true" tabindex="-1"></a>testpredict</span></code></pre></div>
<pre><code>## # A tibble: 9,514 x 13
##    .pred_class Season Team  Date       Opponent Location Outcome
##    &lt;fct&gt;       &lt;chr&gt;  &lt;chr&gt; &lt;date&gt;     &lt;chr&gt;    &lt;chr&gt;    &lt;fct&gt;  
##  1 W           2014-… Abil… 2014-12-22 South C… N        W      
##  2 L           2014-… Abil… 2015-03-05 Incarna… A        L      
##  3 L           2014-… Air … 2015-01-31 UNLV     A        L      
##  4 W           2014-… Air … 2015-02-04 New Mex… H        W      
##  5 L           2014-… Akron 2014-11-23 South C… N        W      
##  6 W           2014-… Akron 2014-12-04 Western… H        W      
##  7 W           2014-… Akron 2015-01-03 Coppin … H        W      
##  8 W           2014-… Akron 2015-02-21 Miami (… H        L      
##  9 W           2014-… Akron 2015-03-09 Norther… H        W      
## 10 W           2014-… Alab… 2014-11-25 Jackson… H        L      
## # … with 9,504 more rows, and 6 more variables:
## #   Cumulative_Mean_Possessions &lt;dbl&gt;, Cumulative_Mean_PPP &lt;dbl&gt;,
## #   TeamSRS &lt;dbl&gt;, Opponent_Cumulative_Mean_Possessions &lt;dbl&gt;,
## #   Opponent_Cumulative_Mean_PPP &lt;dbl&gt;, OpponentSRS &lt;dbl&gt;</code></pre>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="logistic-regression.html#cb179-1" aria-hidden="true" tabindex="-1"></a>testpredict <span class="ot">&lt;-</span> log_fit <span class="sc">%&gt;%</span> <span class="fu">predict</span>(<span class="at">new_data =</span> log_test, <span class="at">type=</span><span class="st">&quot;prob&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb179-2"><a href="logistic-regression.html#cb179-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(testpredict)</span>
<span id="cb179-3"><a href="logistic-regression.html#cb179-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-4"><a href="logistic-regression.html#cb179-4" aria-hidden="true" tabindex="-1"></a>testpredict</span></code></pre></div>
<pre><code>## # A tibble: 9,514 x 15
##    .pred_L .pred_W .pred_class Season Team  Date       Opponent Location Outcome
##      &lt;dbl&gt;   &lt;dbl&gt; &lt;fct&gt;       &lt;chr&gt;  &lt;chr&gt; &lt;date&gt;     &lt;chr&gt;    &lt;chr&gt;    &lt;fct&gt;  
##  1  0.483   0.517  W           2014-… Abil… 2014-12-22 South C… N        W      
##  2  0.943   0.0566 L           2014-… Abil… 2015-03-05 Incarna… A        L      
##  3  0.721   0.279  L           2014-… Air … 2015-01-31 UNLV     A        L      
##  4  0.443   0.557  W           2014-… Air … 2015-02-04 New Mex… H        W      
##  5  0.684   0.316  L           2014-… Akron 2014-11-23 South C… N        W      
##  6  0.0183  0.982  W           2014-… Akron 2014-12-04 Western… H        W      
##  7  0.0224  0.978  W           2014-… Akron 2015-01-03 Coppin … H        W      
##  8  0.154   0.846  W           2014-… Akron 2015-02-21 Miami (… H        L      
##  9  0.190   0.810  W           2014-… Akron 2015-03-09 Norther… H        W      
## 10  0.377   0.623  W           2014-… Alab… 2014-11-25 Jackson… H        L      
## # … with 9,504 more rows, and 6 more variables:
## #   Cumulative_Mean_Possessions &lt;dbl&gt;, Cumulative_Mean_PPP &lt;dbl&gt;,
## #   TeamSRS &lt;dbl&gt;, Opponent_Cumulative_Mean_Possessions &lt;dbl&gt;,
## #   Opponent_Cumulative_Mean_PPP &lt;dbl&gt;, OpponentSRS &lt;dbl&gt;</code></pre>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="logistic-regression.html#cb181-1" aria-hidden="true" tabindex="-1"></a><span class="fu">metrics</span>(testpredict, Outcome, .pred_class)</span></code></pre></div>
<pre><code>## # A tibble: 2 x 3
##   .metric  .estimator .estimate
##   &lt;chr&gt;    &lt;chr&gt;          &lt;dbl&gt;
## 1 accuracy binary         0.742
## 2 kap      binary         0.484</code></pre>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb183-1"><a href="logistic-regression.html#cb183-1" aria-hidden="true" tabindex="-1"></a>testpredict <span class="sc">%&gt;%</span></span>
<span id="cb183-2"><a href="logistic-regression.html#cb183-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">conf_mat</span>(Outcome, .pred_class)</span></code></pre></div>
<pre><code>##           Truth
## Prediction    L    W
##          L 3536 1200
##          W 1256 3522</code></pre>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb185-1"><a href="logistic-regression.html#cb185-1" aria-hidden="true" tabindex="-1"></a><span class="fu">roc_auc</span>(testpredict, <span class="at">truth =</span> Outcome, .pred_W)</span></code></pre></div>
<pre><code>## # A tibble: 1 x 3
##   .metric .estimator .estimate
##   &lt;chr&gt;   &lt;chr&gt;          &lt;dbl&gt;
## 1 roc_auc binary         0.175</code></pre>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="logistic-regression.html#cb187-1" aria-hidden="true" tabindex="-1"></a><span class="fu">roc_auc</span>(testpredict, <span class="at">truth =</span> Outcome, .pred_L)</span></code></pre></div>
<pre><code>## # A tibble: 1 x 3
##   .metric .estimator .estimate
##   &lt;chr&gt;   &lt;chr&gt;          &lt;dbl&gt;
## 1 roc_auc binary         0.825</code></pre>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb189-1"><a href="logistic-regression.html#cb189-1" aria-hidden="true" tabindex="-1"></a>roc_data <span class="ot">&lt;-</span> <span class="fu">roc_curve</span>(testpredict, <span class="at">truth =</span> Outcome, .pred_L) </span>
<span id="cb189-2"><a href="logistic-regression.html#cb189-2" aria-hidden="true" tabindex="-1"></a>roc_data <span class="sc">%&gt;%</span>  </span>
<span id="cb189-3"><a href="logistic-regression.html#cb189-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">1</span> <span class="sc">-</span> specificity, <span class="at">y =</span> sensitivity)) <span class="sc">+</span></span>
<span id="cb189-4"><a href="logistic-regression.html#cb189-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>() <span class="sc">+</span></span>
<span id="cb189-5"><a href="logistic-regression.html#cb189-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">lty =</span> <span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb189-6"><a href="logistic-regression.html#cb189-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_equal</span>()</span></code></pre></div>
<p><img src="advancedsportsdataanalysis_files/figure-html/unnamed-chunk-117-1.png" width="672" /></p>
</div>
<div id="how-well-did-it-do-with-nebraska" class="section level2" number="6.5">
<h2><span class="header-section-number">6.5</span> How well did it do with Nebraska?</h2>
<p>Let’s grab predictions for Nebraska from both our test and train data and take a look.</p>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb190-1"><a href="logistic-regression.html#cb190-1" aria-hidden="true" tabindex="-1"></a>nutrain <span class="ot">&lt;-</span> trainpredict <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Team <span class="sc">==</span> <span class="st">&quot;Nebraska&quot;</span>, Season <span class="sc">==</span> <span class="st">&quot;2020-2021&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="logistic-regression.html#cb191-1" aria-hidden="true" tabindex="-1"></a>nutest <span class="ot">&lt;-</span> testpredict <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Team <span class="sc">==</span> <span class="st">&quot;Nebraska&quot;</span>, Season <span class="sc">==</span> <span class="st">&quot;2020-2021&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb192-1"><a href="logistic-regression.html#cb192-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bind_rows</span>(nutrain, nutest) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(Date)</span></code></pre></div>
<pre><code>## # A tibble: 23 x 15
##    .pred_L .pred_W .pred_class Season Team  Date       Opponent Location Outcome
##      &lt;dbl&gt;   &lt;dbl&gt; &lt;fct&gt;       &lt;chr&gt;  &lt;chr&gt; &lt;date&gt;     &lt;chr&gt;    &lt;chr&gt;    &lt;fct&gt;  
##  1 3.63e-4  1.00   W           2020-… Nebr… 2020-11-25 McNeese… H        W      
##  2 1.49e-1  0.851  W           2020-… Nebr… 2020-11-26 Nevada   H        L      
##  3 2.42e-2  0.976  W           2020-… Nebr… 2020-11-28 North D… H        W      
##  4 5.76e-2  0.942  W           2020-… Nebr… 2020-12-01 South D… H        W      
##  5 5.67e-1  0.433  L           2020-… Nebr… 2020-12-09 Georgia… H        L      
##  6 9.30e-1  0.0703 L           2020-… Nebr… 2020-12-11 Creight… A        L      
##  7 9.51e-1  0.0485 L           2020-… Nebr… 2020-12-22 Wiscons… A        L      
##  8 8.73e-1  0.127  L           2020-… Nebr… 2020-12-25 Michigan H        L      
##  9 9.42e-1  0.0582 L           2020-… Nebr… 2020-12-30 Ohio St… A        L      
## 10 6.14e-1  0.386  L           2020-… Nebr… 2021-01-02 Michiga… H        L      
## # … with 13 more rows, and 6 more variables: Cumulative_Mean_Possessions &lt;dbl&gt;,
## #   Cumulative_Mean_PPP &lt;dbl&gt;, TeamSRS &lt;dbl&gt;,
## #   Opponent_Cumulative_Mean_Possessions &lt;dbl&gt;,
## #   Opponent_Cumulative_Mean_PPP &lt;dbl&gt;, OpponentSRS &lt;dbl&gt;</code></pre>
<p>Our model didn’t foresee Teddy Allen hitting a last second shot to beat Penn State, and it was confident we’d beat Nevada early in the season, but alas, we didn’t. Otherwise, it’s been pretty sure we’d lose the games we’ve lost.</p>
<p>But this is just looking at season means. How could you improve this?</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="xgboost.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/05-logisticregression.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["advancedsportsdataanalysis.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
