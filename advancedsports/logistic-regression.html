<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.247">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Advanced Sports Data Analysis - 3&nbsp; Modeling and logistic regression</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./random-forest.html" rel="next">
<link href="./installations.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Modeling and logistic regression</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Advanced Sports Data Analysis</a> 
        <div class="sidebar-tools-main">
    <a href="" title="Download" id="sidebar-tool-dropdown-0" class="sidebar-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi bi-download"></i></a>
    <ul class="dropdown-menu" aria-labelledby="sidebar-tool-dropdown-0">
        <li>
          <a class="dropdown-item sidebar-tools-main-item" href="./Advanced-Sports-Data-Analysis.pdf">
            <i class="bi bi-bi-file-pdf pe-1"></i>
          Download PDF
          </a>
        </li>
        <li>
          <a class="dropdown-item sidebar-tools-main-item" href="./Advanced-Sports-Data-Analysis.epub">
            <i class="bi bi-bi-journal pe-1"></i>
          Download ePub
          </a>
        </li>
    </ul>
</div>
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./installations.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Installations</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./logistic-regression.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Modeling and logistic regression</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./random-forest.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Decision trees and random forests</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./xgboost.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">XGBoost</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lightgbm.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">LightGBM</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./svm.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Support Vector Machines</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./predictions.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Making predictions with new games</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./regression-basics.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Using linear regression to predict a number</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./random-forest-for-regression.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Random forests to predict a number</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./xgboost-for-regression.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">XGBoost for regression</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lightgbm-for-regression.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">LightGBM for regression</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#the-basics" id="toc-the-basics" class="nav-link active" data-scroll-target="#the-basics"><span class="toc-section-number">3.1</span>  The basics</a></li>
  <li><a href="#feature-engineering" id="toc-feature-engineering" class="nav-link" data-scroll-target="#feature-engineering"><span class="toc-section-number">3.2</span>  Feature engineering</a>
  <ul class="collapse">
  <li><a href="#exercise-1-setting-up-your-data" id="toc-exercise-1-setting-up-your-data" class="nav-link" data-scroll-target="#exercise-1-setting-up-your-data"><span class="toc-section-number">3.2.1</span>  Exercise 1: setting up your data</a></li>
  <li><a href="#exercise-2-opponent-side" id="toc-exercise-2-opponent-side" class="nav-link" data-scroll-target="#exercise-2-opponent-side"><span class="toc-section-number">3.2.2</span>  Exercise 2: Opponent side</a></li>
  <li><a href="#exercise-3-joining" id="toc-exercise-3-joining" class="nav-link" data-scroll-target="#exercise-3-joining"><span class="toc-section-number">3.2.3</span>  Exercise 3: Joining</a></li>
  </ul></li>
  <li><a href="#modeling" id="toc-modeling" class="nav-link" data-scroll-target="#modeling"><span class="toc-section-number">3.3</span>  Modeling</a>
  <ul class="collapse">
  <li><a href="#exercise-4-who-won" id="toc-exercise-4-who-won" class="nav-link" data-scroll-target="#exercise-4-who-won"><span class="toc-section-number">3.3.1</span>  Exercise 4: Who won?</a></li>
  <li><a href="#exercise-5-looking-at-the-factors" id="toc-exercise-5-looking-at-the-factors" class="nav-link" data-scroll-target="#exercise-5-looking-at-the-factors"><span class="toc-section-number">3.3.2</span>  Exercise 5: Looking at the factors</a></li>
  <li><a href="#exercise-6-releveling-the-factors" id="toc-exercise-6-releveling-the-factors" class="nav-link" data-scroll-target="#exercise-6-releveling-the-factors"><span class="toc-section-number">3.3.3</span>  Exercise 6: Releveling the factors</a></li>
  </ul></li>
  <li><a href="#visualizing-the-decision-boundary" id="toc-visualizing-the-decision-boundary" class="nav-link" data-scroll-target="#visualizing-the-decision-boundary"><span class="toc-section-number">3.4</span>  Visualizing the decision boundary</a></li>
  <li><a href="#the-logistic-regression" id="toc-the-logistic-regression" class="nav-link" data-scroll-target="#the-logistic-regression"><span class="toc-section-number">3.5</span>  The logistic regression</a>
  <ul class="collapse">
  <li><a href="#exercise-7-what-are-we-splitting" id="toc-exercise-7-what-are-we-splitting" class="nav-link" data-scroll-target="#exercise-7-what-are-we-splitting"><span class="toc-section-number">3.5.1</span>  Exercise 7: What are we splitting?</a></li>
  <li><a href="#exercise-8-making-a-workflow" id="toc-exercise-8-making-a-workflow" class="nav-link" data-scroll-target="#exercise-8-making-a-workflow"><span class="toc-section-number">3.5.2</span>  Exercise 8: Making a workflow</a></li>
  </ul></li>
  <li><a href="#evaluating-the-fit" id="toc-evaluating-the-fit" class="nav-link" data-scroll-target="#evaluating-the-fit"><span class="toc-section-number">3.6</span>  Evaluating the fit</a>
  <ul class="collapse">
  <li><a href="#exercise-9-metrics" id="toc-exercise-9-metrics" class="nav-link" data-scroll-target="#exercise-9-metrics"><span class="toc-section-number">3.6.1</span>  Exercise 9: Metrics</a></li>
  <li><a href="#exercise-10-confusion-matrix" id="toc-exercise-10-confusion-matrix" class="nav-link" data-scroll-target="#exercise-10-confusion-matrix"><span class="toc-section-number">3.6.2</span>  Exercise 10: Confusion matrix</a></li>
  </ul></li>
  <li><a href="#comparing-it-to-test-data" id="toc-comparing-it-to-test-data" class="nav-link" data-scroll-target="#comparing-it-to-test-data"><span class="toc-section-number">3.7</span>  Comparing it to test data</a>
  <ul class="collapse">
  <li><a href="#exercise-11-testing" id="toc-exercise-11-testing" class="nav-link" data-scroll-target="#exercise-11-testing"><span class="toc-section-number">3.7.1</span>  Exercise 11: Testing</a></li>
  </ul></li>
  <li><a href="#how-well-did-it-do-with-nebraska" id="toc-how-well-did-it-do-with-nebraska" class="nav-link" data-scroll-target="#how-well-did-it-do-with-nebraska"><span class="toc-section-number">3.8</span>  How well did it do with Nebraska?</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Modeling and logistic regression</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="the-basics" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="the-basics"><span class="header-section-number">3.1</span> The basics</h2>
<p>One of the most common – and seemingly least rigorous – parts of sports journalism is the prediction. There are no shortage of people making predictions about who will win a game or a league. Sure they have a method – looking at how a team is playing, looking at the players, consulting their gut – but rarely ever do you hear of a sports pundit using a model.</p>
<p>We’re going to change that. Throughout this class, you’ll learn how to use modeling to make predictions. Some of these methods will predict numeric values (like how many points will a team score based on certain inputs). Some will predict categorical values (W or L, Yes or No, All Star or Not).</p>
<p>There are lots of problems in the world where the answer is not a number but <em>a classification</em>: Did they win or lose? Did the player get drafted or no? Is this player a flight risk to transfer or not?</p>
<p>These are problems of classification and there are algorithms we can use to estimate the probability that X will be the outcome. How likely is it that this team with these stats will win this game?</p>
<p>Where this gets interesting is in the middle.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidymodels)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(hoopR)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(zoo)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>What we need to do here is get both sides of the game. We’ll start with getting the box scores and then we’re going to remove all games involving non-Division I schools.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>games <span class="ot">&lt;-</span> <span class="fu">load_mbb_team_box</span>(<span class="at">seasons =</span> <span class="dv">2015</span><span class="sc">:</span><span class="dv">2024</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>nond1 <span class="ot">&lt;-</span> games <span class="sc">|&gt;</span> <span class="fu">group_by</span>(team_id, season) <span class="sc">|&gt;</span> <span class="fu">tally</span>() <span class="sc">|&gt;</span> <span class="fu">filter</span>(n <span class="sc">&lt;</span> <span class="dv">10</span>) <span class="sc">|&gt;</span> <span class="fu">select</span>(team_id)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>nond1 <span class="ot">&lt;-</span> <span class="fu">pull</span>(nond1)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> games <span class="sc">|&gt;</span> <span class="fu">filter</span>(<span class="sc">!</span>team_id <span class="sc">%in%</span> nond1 <span class="sc">&amp;</span> <span class="sc">!</span>opponent_team_id <span class="sc">%in%</span> nond1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="feature-engineering" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="feature-engineering"><span class="header-section-number">3.2</span> Feature engineering</h2>
<p>Feature engineering is the process of using what you know about something – domain knowledge – to find features in data that can be used in machine learning algorithms. Sports is a great place for this because not only do we know a lot because we follow the sport, but lots of other people are looking at this all the time. Creativity is good.</p>
<p>A number of basketball heads – including Ken Pomeroy of KenPom fame – have noticed that one of the predictors of the outcome of basketball games are possession metrics. How efficient are teams with the possessions they have? Can’t score if you don’t have the ball, so how good is a team at pushing the play and getting more possessions, giving themselves more chances to score?</p>
<p>One problem? Possessions aren’t in typical metrics. They aren’t usually tracked. But you can estimate them from typical box scores. The way to do that is like this:</p>
<p><code>Possessions = Field Goal Attempts – Offensive Rebounds + Turnovers + (0.475 * Free Throw Attempts)</code></p>
<p>If you look at the data we already have, however, you’ll see possessions are not actually in the data. Which is unfortunate. But we can calculate it pretty easily.</p>
<p>Then we’ll use the possessions estimate formula to get that, so we can then calculate offensive and defensive efficiency – points per 100 possessions.</p>
<p>Then, we’re going to create season cumulative averages of those efficiencies, but we’re going to lag them by one game. Why? Because we don’t know what the offensive efficiency is for that game <em>before</em> that game. We only know what it was going into the game. So the lag gives us what each team’s metrics are <em>before</em> they play the game. That’s good. We need that for modeling. Otherwise, we’re cheating.</p>
<p>We’ll save that to a new dataframe called <code>teamside</code>.</p>
<section id="exercise-1-setting-up-your-data" class="level3" data-number="3.2.1">
<h3 data-number="3.2.1" class="anchored" data-anchor-id="exercise-1-setting-up-your-data"><span class="header-section-number">3.2.1</span> Exercise 1: setting up your data</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>teamside <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span> </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(team, season) <span class="sc">|&gt;</span> </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(game_date) <span class="sc">|&gt;</span> </span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    team_??????????? <span class="ot">=</span> field_goals_attempted <span class="sc">-</span> offensive_rebounds <span class="sc">+</span> turnovers <span class="sc">+</span> (.<span class="dv">475</span> <span class="sc">*</span> free_throws_attempted),</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    team_points_per_?????????? <span class="ot">=</span> team_score<span class="sc">/</span>team_possessions,</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">team_defensive_points_per_possession =</span> opponent_team_score<span class="sc">/</span>team_possessions,</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">team_offensive_efficiency =</span> team_points_per_possession <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">team_defensive_efficiency =</span> team_defensive_points_per_possession <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">team_season_offensive_efficiency =</span> <span class="fu">lag</span>(<span class="fu">cummean</span>(team_offensive_efficiency), <span class="at">n=</span><span class="dv">1</span>),</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">team_season_defensive_efficiency =</span> <span class="fu">lag</span>(<span class="fu">cummean</span>(team_defensive_efficiency), <span class="at">n=</span><span class="dv">1</span>),  </span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">score_margin =</span> team_score <span class="sc">-</span> opponent_team_score,</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">absolute_score_margin =</span> <span class="fu">abs</span>(score_margin)</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(absolute_score_margin <span class="sc">&lt;=</span> <span class="dv">40</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">

</div>
<p>Now we’re going to repeat the process for the opponent, but we’re going to use some tricks here. Because we have box score data, it means every game is in here twice. So every team in one box score is the opponent in another. So we’re going to use that in our favor to create the opponent side of the equation here and then we’ll join it back together afterwards. We start by dropping the opponent_team_id, which we’ll get back by renaming the team_id to that, then renaming our team stats to opponent stats.</p>
</section>
<section id="exercise-2-opponent-side" class="level3" data-number="3.2.2">
<h3 data-number="3.2.2" class="anchored" data-anchor-id="exercise-2-opponent-side"><span class="header-section-number">3.2.2</span> Exercise 2: Opponent side</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>opponentside <span class="ot">&lt;-</span> teamside <span class="sc">|&gt;</span> </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>?????????????) <span class="sc">|&gt;</span> </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">opponent_team_id =</span> team_id,</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">opponent_season_offensive_efficiency =</span> team_season_offensive_efficiency,</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">opponent_season_defensive_efficiency =</span> team_season_defensive_efficiency</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>    game_id,</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>    opponent_team_id,</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>    opponent_season_offensive_efficiency,</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>    opponent_season_defensive_efficiency</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">

</div>
<p>Now, let’s join them.</p>
</section>
<section id="exercise-3-joining" class="level3" data-number="3.2.3">
<h3 data-number="3.2.3" class="anchored" data-anchor-id="exercise-3-joining"><span class="header-section-number">3.2.3</span> Exercise 3: Joining</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>bothsides <span class="ot">&lt;-</span> ???????? <span class="sc">|&gt;</span> <span class="fu">inner_join</span>(?????????)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>Joining with `by = join_by(game_id, opponent_team_id)`</code></pre>
</div>
</div>
</section>
</section>
<section id="modeling" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="modeling"><span class="header-section-number">3.3</span> Modeling</h2>
<p>Now we begin the process of creating a model. Modeling in data science has a <strong>ton</strong> of details, but the process for each model type is similar.</p>
<ol type="1">
<li>Split your data into training and testing data sets. A common split is 80/20.</li>
<li>Train the model on the training dataset.</li>
<li>Evaluate the model on the training data.</li>
<li>Apply the model to the testing data.</li>
<li>Evaluate the model on the test data.</li>
</ol>
<p>From there, it’s how you want to use the model. We’ll walk through a simple example here, using a simple model – a logistic regression model.</p>
<p>What we’re trying to do here is predict which team will win given their efficiency with the ball, expressed as the cumulative average efficiency. However, to make a prediction, we need to know their stats <em>BEFORE</em> the game – what we knew about the team going into the game in question.</p>
<section id="exercise-4-who-won" class="level3" data-number="3.3.1">
<h3 data-number="3.3.1" class="anchored" data-anchor-id="exercise-4-who-won"><span class="header-section-number">3.3.1</span> Exercise 4: Who won?</h3>
<p>The last problem to solve? Who won? We can add this with conditional logic. The other thing we’re doing here is we’re going to is we’re going to convert our new team_result column into a factor. What is a factor? A factor is a type of data in R that stores categorical values that have a limited number of differences. So wins and losses are a perfect factor. Modeling libraries are looking for factors so it can treat the differences in the data as categories, so that’s why we’re converting it here.</p>
<p>The logic? If the team score is greater than the opponent team score, that’s a win. Otherwise, they take the L as the kids say these days.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>bothsides <span class="ot">&lt;-</span> bothsides <span class="sc">|&gt;</span> <span class="fu">mutate</span>(</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">team_result =</span> <span class="fu">as.factor</span>(<span class="fu">case_when</span>(</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    team_score <span class="sc">&gt;</span> ??????????? <span class="sc">~</span> <span class="st">"W"</span>,</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    opponent_team_score <span class="sc">&gt;</span> ???????? <span class="sc">~</span> <span class="st">"L"</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">

</div>
<p>Now that we’ve done that, we need to look at the order of our factors.</p>
</section>
<section id="exercise-5-looking-at-the-factors" class="level3" data-number="3.3.2">
<h3 data-number="3.3.2" class="anchored" data-anchor-id="exercise-5-looking-at-the-factors"><span class="header-section-number">3.3.2</span> Exercise 5: Looking at the factors</h3>
<p>To do that, we first need to know what R sees when it sees our <code>team_result</code> factor. Is a win first or is a loss first?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(bothsides<span class="sc">$</span>????_??????)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "L" "W"</code></pre>
</div>
</div>
<p>The order listed here is the order they are in. What this means is that our predictions will be done through the lens of losses. That doesn’t make intuitive sense to us. We want to know who will win! We can reorder the factors with <code>relevel</code>.</p>
</section>
<section id="exercise-6-releveling-the-factors" class="level3" data-number="3.3.3">
<h3 data-number="3.3.3" class="anchored" data-anchor-id="exercise-6-releveling-the-factors"><span class="header-section-number">3.3.3</span> Exercise 6: Releveling the factors</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>bothsides<span class="sc">$</span>team_result <span class="ot">&lt;-</span> <span class="fu">relevel</span>(bothsides<span class="sc">$</span>team_result, <span class="at">ref=</span><span class="st">"?"</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(bothsides<span class="sc">$</span>team_result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] "W" "L"</code></pre>
</div>
</div>
<p>For simplicity, let’s limit the number of columns we’re going to feed our model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>modelgames <span class="ot">&lt;-</span> bothsides <span class="sc">|&gt;</span> </span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    game_id, </span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    game_date, </span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    team_short_display_name, </span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    opponent_team_short_display_name, </span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    season, </span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>    team_season_offensive_efficiency,</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>    team_season_defensive_efficiency,</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>    opponent_season_offensive_efficiency,</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>    opponent_season_defensive_efficiency,</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>    team_result</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> <span class="fu">na.omit</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="visualizing-the-decision-boundary" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="visualizing-the-decision-boundary"><span class="header-section-number">3.4</span> Visualizing the decision boundary</h2>
<p>This is just one dimension of the data, but it can illustrate how this works. You can almost see a line running through the middle, with a lot of overlap. The further left or right you go, the less overlap. You can read it like this: If this team scores this efficiently and the opponent scores this efficiently, most of the time this team wins. Or loses. It just depends on where the dot ends up.</p>
<p>That neatly captures the probabilities we’re looking at here.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">data=</span>modelgames, <span class="fu">aes</span>(<span class="at">x=</span>team_season_offensive_efficiency, <span class="at">y=</span>opponent_season_offensive_efficiency, <span class="at">color=</span>team_result))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="logistic-regression_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="the-logistic-regression" class="level2" data-number="3.5">
<h2 data-number="3.5" class="anchored" data-anchor-id="the-logistic-regression"><span class="header-section-number">3.5</span> The logistic regression</h2>
<p>To create a model, we have to go through a process. That process starts with splitting data where we know the outomes into two groups – training and testing. The training data is what we will use to create our model. The testing data is how we will determine how good it is. Then, going forward, our model can predict games we <em>haven’t</em> seen yet.</p>
<p>To do this, we’re going to first split our <code>modelgames</code> data into two groups – with 80 percent of it in one, 20 percent in the other. We do that by feeding our simplified dataframe into the <code>initial_split</code> function. Then we’ll explicitly name those into new dataframes called train and test.</p>
<section id="exercise-7-what-are-we-splitting" class="level3" data-number="3.5.1">
<h3 data-number="3.5.1" class="anchored" data-anchor-id="exercise-7-what-are-we-splitting"><span class="header-section-number">3.5.1</span> Exercise 7: What are we splitting?</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>log_split <span class="ot">&lt;-</span> <span class="fu">initial_split</span>(?????????, <span class="at">prop =</span> .<span class="dv">8</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>log_train <span class="ot">&lt;-</span> <span class="fu">training</span>(log_split)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>log_test <span class="ot">&lt;-</span> <span class="fu">testing</span>(log_split)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">

</div>
<p>Now we have two dataframes – log_train and log_test – that we can now use for modeling.</p>
<p>First step to making a model is to set what type of model this will be. We’re going to name our model object – log_mod works because this is a logistic regression model. We’ll use the logistic_reg function in parsnip (the modeling library in Tidymodels) and set the engine to “glm”. The mode in our case is “classification” because we’re trying to classify something as a W or L. Later, we’ll use “regression” to predict numbers.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>log_mod <span class="ot">&lt;-</span> </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">logistic_reg</span>() <span class="sc">|&gt;</span> </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_engine</span>(<span class="st">"glm"</span>) <span class="sc">|&gt;</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_mode</span>(<span class="st">"classification"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The next step is to create a recipe. This is a series of steps we’ll use to put our data into our model. For example – what is predicting what? And what aren’t predictors and what are? And do we have to do any pre-processing of the data?</p>
<p>The first part of the recipe is the formula. In this case, we’re saying – in real words – <code>team_result</code> <em>is approximately modeled by</em> our predictors, which we represent as <code>.</code> which means all the stuff. Then, importantly, we say what <em>isn’t</em> a predictor next with update_role. So the team name, the game date and things like that are <em>not</em> predictors. So we need to tell it that. The last step is normalizing our numbers. With logistic regression, scale differences in numbers can skew things, so we’re going to turn everything into Z-scores.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>log_recipe <span class="ot">&lt;-</span> </span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">recipe</span>(team_result <span class="sc">~</span> ., <span class="at">data =</span> log_train) <span class="sc">|&gt;</span> </span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">update_role</span>(game_id, game_date, team_short_display_name, opponent_team_short_display_name, season, <span class="at">new_role =</span> <span class="st">"ID"</span>) <span class="sc">|&gt;</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">step_normalize</span>(<span class="fu">all_predictors</span>())</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(log_recipe)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 4
   variable                             type      role      source  
   &lt;chr&gt;                                &lt;list&gt;    &lt;chr&gt;     &lt;chr&gt;   
 1 game_id                              &lt;chr [2]&gt; ID        original
 2 game_date                            &lt;chr [1]&gt; ID        original
 3 team_short_display_name              &lt;chr [3]&gt; ID        original
 4 opponent_team_short_display_name     &lt;chr [3]&gt; ID        original
 5 season                               &lt;chr [2]&gt; ID        original
 6 team_season_offensive_efficiency     &lt;chr [2]&gt; predictor original
 7 team_season_defensive_efficiency     &lt;chr [2]&gt; predictor original
 8 opponent_season_offensive_efficiency &lt;chr [2]&gt; predictor original
 9 opponent_season_defensive_efficiency &lt;chr [2]&gt; predictor original
10 team_result                          &lt;chr [3]&gt; outcome   original</code></pre>
</div>
</div>
<p>Now we have enough for a workflow. A workflow is what we use to put it all together. In it, we add our model definition and our recipe.</p>
</section>
<section id="exercise-8-making-a-workflow" class="level3" data-number="3.5.2">
<h3 data-number="3.5.2" class="anchored" data-anchor-id="exercise-8-making-a-workflow"><span class="header-section-number">3.5.2</span> Exercise 8: Making a workflow</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>log_workflow <span class="ot">&lt;-</span> </span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">workflow</span>() <span class="sc">|&gt;</span> </span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_model</span>(log_???) <span class="sc">|&gt;</span> </span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_recipe</span>(log_??????)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">

</div>
<p>And now we fit our model (this can take a few minutes).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>log_fit <span class="ot">&lt;-</span> </span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  log_workflow <span class="sc">|&gt;</span> </span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>(<span class="at">data =</span> log_train)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="evaluating-the-fit" class="level2" data-number="3.6">
<h2 data-number="3.6" class="anchored" data-anchor-id="evaluating-the-fit"><span class="header-section-number">3.6</span> Evaluating the fit</h2>
<p>With logistic regression, there’s two things we’re looking at: The prediction and the probabilities. We can get those with two different fits and combine them together.</p>
<p>First, you can see the predictions like this:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>trainpredict <span class="ot">&lt;-</span> log_fit <span class="sc">|&gt;</span> <span class="fu">predict</span>(<span class="at">new_data =</span> log_train) <span class="sc">|&gt;</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(log_train)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(trainpredict)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 11
  .pred_class   game_id game_date  team_short_display_n…¹ opponent_team_short_…²
  &lt;fct&gt;           &lt;int&gt; &lt;date&gt;     &lt;chr&gt;                  &lt;chr&gt;                 
1 L           401096956 2018-11-23 Marquette              Louisville            
2 W           400843818 2016-01-17 S Illinois             Drake                 
3 W           400986857 2017-12-21 BYU                    Idaho St              
4 L           401491229 2023-01-11 Loyola MD              Bucknell              
5 L           401489063 2022-12-10 N Arizona              Utah Valley           
6 W           401484595 2023-02-04 Tennessee              Auburn                
# ℹ abbreviated names: ¹​team_short_display_name,
#   ²​opponent_team_short_display_name
# ℹ 6 more variables: season &lt;int&gt;, team_season_offensive_efficiency &lt;dbl&gt;,
#   team_season_defensive_efficiency &lt;dbl&gt;,
#   opponent_season_offensive_efficiency &lt;dbl&gt;,
#   opponent_season_defensive_efficiency &lt;dbl&gt;, team_result &lt;fct&gt;</code></pre>
</div>
</div>
<p>Then, we can just add it to <code>trainpredict</code> using <code>bind_cols</code>, which means we’re going to bind the columns of this new fit to the old trainpredict.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>trainpredict <span class="ot">&lt;-</span> log_fit <span class="sc">|&gt;</span> <span class="fu">predict</span>(<span class="at">new_data =</span> log_train, <span class="at">type=</span><span class="st">"prob"</span>) <span class="sc">|&gt;</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(trainpredict)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(trainpredict)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 13
  .pred_W .pred_L .pred_class   game_id game_date  team_short_display_name
    &lt;dbl&gt;   &lt;dbl&gt; &lt;fct&gt;           &lt;int&gt; &lt;date&gt;     &lt;chr&gt;                  
1   0.341   0.659 L           401096956 2018-11-23 Marquette              
2   0.772   0.228 W           400843818 2016-01-17 S Illinois             
3   0.774   0.226 W           400986857 2017-12-21 BYU                    
4   0.271   0.729 L           401491229 2023-01-11 Loyola MD              
5   0.259   0.741 L           401489063 2022-12-10 N Arizona              
6   0.712   0.288 W           401484595 2023-02-04 Tennessee              
# ℹ 7 more variables: opponent_team_short_display_name &lt;chr&gt;, season &lt;int&gt;,
#   team_season_offensive_efficiency &lt;dbl&gt;,
#   team_season_defensive_efficiency &lt;dbl&gt;,
#   opponent_season_offensive_efficiency &lt;dbl&gt;,
#   opponent_season_defensive_efficiency &lt;dbl&gt;, team_result &lt;fct&gt;</code></pre>
</div>
</div>
<p>There’s several metrics to look at to evaluate the model on our training data, but the two we will use are accuracy and roc_auc. They both are pointing toward how well the model did in two different ways. The accuracy metric looks at the number of predictions that are correct when compared to known results. The inputs here are the data, the column that has the actual result, and the column with the prediction, called <code>.pred_class</code>.</p>
<section id="exercise-9-metrics" class="level3" data-number="3.6.1">
<h3 data-number="3.6.1" class="anchored" data-anchor-id="exercise-9-metrics"><span class="header-section-number">3.6.1</span> Exercise 9: Metrics</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">metrics</span>(trainpredict, ????_??????, .pred_class)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 3
  .metric  .estimator .estimate
  &lt;chr&gt;    &lt;chr&gt;          &lt;dbl&gt;
1 accuracy binary         0.679
2 kap      binary         0.357</code></pre>
</div>
</div>
<p>So how accurate is our model? If we’re looking for perfection, we’re far from it. But if we’re looking to make straight up win loss bets … we’re doing okay!</p>
<p>Another way to look at the results is the confusion matrix. The confusion matrix shows what was predicted compared to what actually happened. The squares are True Positives, False Positives, True Negatives and False Negatives. True values vs the total values make up the accuracy.</p>
</section>
<section id="exercise-10-confusion-matrix" class="level3" data-number="3.6.2">
<h3 data-number="3.6.2" class="anchored" data-anchor-id="exercise-10-confusion-matrix"><span class="header-section-number">3.6.2</span> Exercise 10: Confusion matrix</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>trainpredict <span class="sc">|&gt;</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">conf_mat</span>(????_result, .pred_?????)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>          Truth
Prediction     W     L
         W 26243 12435
         L 12440 26283</code></pre>
</div>
</div>
</section>
</section>
<section id="comparing-it-to-test-data" class="level2" data-number="3.7">
<h2 data-number="3.7" class="anchored" data-anchor-id="comparing-it-to-test-data"><span class="header-section-number">3.7</span> Comparing it to test data</h2>
<p>Now we can apply our fit to the test data to see how robust it is. If the metrics are similar, that’s good – it means our model is robust. If the metrics change a lot, that’s bad. It means our model is guessing.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>testpredict <span class="ot">&lt;-</span> log_fit <span class="sc">|&gt;</span> <span class="fu">predict</span>(<span class="at">new_data =</span> log_test) <span class="sc">|&gt;</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(log_test)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>testpredict <span class="ot">&lt;-</span> log_fit <span class="sc">|&gt;</span> <span class="fu">predict</span>(<span class="at">new_data =</span> log_test, <span class="at">type=</span><span class="st">"prob"</span>) <span class="sc">|&gt;</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(testpredict)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>And now some metrics on the test data.</p>
<section id="exercise-11-testing" class="level3" data-number="3.7.1">
<h3 data-number="3.7.1" class="anchored" data-anchor-id="exercise-11-testing"><span class="header-section-number">3.7.1</span> Exercise 11: Testing</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">metrics</span>(????predict, team_result, .pred_class)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 3
  .metric  .estimator .estimate
  &lt;chr&gt;    &lt;chr&gt;          &lt;dbl&gt;
1 accuracy binary         0.677
2 kap      binary         0.353</code></pre>
</div>
</div>
<p>How does that compare to our training data? Is it lower? Higher? Are the changes large – like are we talking about single digit changes or double digit changes? The less it changes, the better.</p>
<p>And now the confusion matrix.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>testpredict <span class="sc">|&gt;</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">conf_mat</span>(team_result, .pred_class)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          Truth
Prediction    W    L
         W 6561 3126
         L 3132 6532</code></pre>
</div>
</div>
<p>How does that compare to the training data?</p>
</section>
</section>
<section id="how-well-did-it-do-with-nebraska" class="level2" data-number="3.8">
<h2 data-number="3.8" class="anchored" data-anchor-id="how-well-did-it-do-with-nebraska"><span class="header-section-number">3.8</span> How well did it do with Nebraska?</h2>
<p>Let’s grab predictions for Nebraska from both our test and train data and take a look.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>nutrain <span class="ot">&lt;-</span> trainpredict <span class="sc">|&gt;</span> <span class="fu">filter</span>(team_short_display_name <span class="sc">==</span> <span class="st">"Nebraska"</span> <span class="sc">&amp;</span>  season <span class="sc">==</span> <span class="dv">2024</span>)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>nutest <span class="ot">&lt;-</span> testpredict <span class="sc">|&gt;</span> <span class="fu">filter</span>(team_short_display_name <span class="sc">==</span> <span class="st">"Nebraska"</span> <span class="sc">&amp;</span> season <span class="sc">==</span> <span class="dv">2024</span>)</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="fu">bind_rows</span>(nutrain, nutest) <span class="sc">|&gt;</span> </span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(game_date) <span class="sc">|&gt;</span> </span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(.pred_W, .pred_class, team_result, team_short_display_name, opponent_team_short_display_name) <span class="sc">|&gt;</span> </span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div id="rxnghnapro" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#rxnghnapro table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#rxnghnapro thead, #rxnghnapro tbody, #rxnghnapro tfoot, #rxnghnapro tr, #rxnghnapro td, #rxnghnapro th {
  border-style: none;
}

#rxnghnapro p {
  margin: 0;
  padding: 0;
}

#rxnghnapro .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#rxnghnapro .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#rxnghnapro .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#rxnghnapro .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#rxnghnapro .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#rxnghnapro .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rxnghnapro .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#rxnghnapro .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#rxnghnapro .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#rxnghnapro .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#rxnghnapro .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#rxnghnapro .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#rxnghnapro .gt_spanner_row {
  border-bottom-style: hidden;
}

#rxnghnapro .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#rxnghnapro .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#rxnghnapro .gt_from_md > :first-child {
  margin-top: 0;
}

#rxnghnapro .gt_from_md > :last-child {
  margin-bottom: 0;
}

#rxnghnapro .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#rxnghnapro .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#rxnghnapro .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#rxnghnapro .gt_row_group_first td {
  border-top-width: 2px;
}

#rxnghnapro .gt_row_group_first th {
  border-top-width: 2px;
}

#rxnghnapro .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#rxnghnapro .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#rxnghnapro .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#rxnghnapro .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rxnghnapro .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#rxnghnapro .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#rxnghnapro .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#rxnghnapro .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#rxnghnapro .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rxnghnapro .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#rxnghnapro .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#rxnghnapro .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#rxnghnapro .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#rxnghnapro .gt_left {
  text-align: left;
}

#rxnghnapro .gt_center {
  text-align: center;
}

#rxnghnapro .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#rxnghnapro .gt_font_normal {
  font-weight: normal;
}

#rxnghnapro .gt_font_bold {
  font-weight: bold;
}

#rxnghnapro .gt_font_italic {
  font-style: italic;
}

#rxnghnapro .gt_super {
  font-size: 65%;
}

#rxnghnapro .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#rxnghnapro .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#rxnghnapro .gt_indent_1 {
  text-indent: 5px;
}

#rxnghnapro .gt_indent_2 {
  text-indent: 10px;
}

#rxnghnapro .gt_indent_3 {
  text-indent: 15px;
}

#rxnghnapro .gt_indent_4 {
  text-indent: 20px;
}

#rxnghnapro .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id=".pred_W">.pred_W</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id=".pred_class">.pred_class</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="team_result">team_result</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="team_short_display_name">team_short_display_name</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="opponent_team_short_display_name">opponent_team_short_display_name</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers=".pred_W" class="gt_row gt_right">0.9904061</td>
<td headers=".pred_class" class="gt_row gt_center">W</td>
<td headers="team_result" class="gt_row gt_center">W</td>
<td headers="team_short_display_name" class="gt_row gt_left">Nebraska</td>
<td headers="opponent_team_short_display_name" class="gt_row gt_left">Rider</td></tr>
    <tr><td headers=".pred_W" class="gt_row gt_right">0.9658976</td>
<td headers=".pred_class" class="gt_row gt_center">W</td>
<td headers="team_result" class="gt_row gt_center">W</td>
<td headers="team_short_display_name" class="gt_row gt_left">Nebraska</td>
<td headers="opponent_team_short_display_name" class="gt_row gt_left">Stony Brook</td></tr>
    <tr><td headers=".pred_W" class="gt_row gt_right">0.7936626</td>
<td headers=".pred_class" class="gt_row gt_center">W</td>
<td headers="team_result" class="gt_row gt_center">W</td>
<td headers="team_short_display_name" class="gt_row gt_left">Nebraska</td>
<td headers="opponent_team_short_display_name" class="gt_row gt_left">Oregon St</td></tr>
    <tr><td headers=".pred_W" class="gt_row gt_right">0.6884860</td>
<td headers=".pred_class" class="gt_row gt_center">W</td>
<td headers="team_result" class="gt_row gt_center">W</td>
<td headers="team_short_display_name" class="gt_row gt_left">Nebraska</td>
<td headers="opponent_team_short_display_name" class="gt_row gt_left">Duquesne</td></tr>
    <tr><td headers=".pred_W" class="gt_row gt_right">0.9602130</td>
<td headers=".pred_class" class="gt_row gt_center">W</td>
<td headers="team_result" class="gt_row gt_center">W</td>
<td headers="team_short_display_name" class="gt_row gt_left">Nebraska</td>
<td headers="opponent_team_short_display_name" class="gt_row gt_left">Fullerton</td></tr>
    <tr><td headers=".pred_W" class="gt_row gt_right">0.4496101</td>
<td headers=".pred_class" class="gt_row gt_center">L</td>
<td headers="team_result" class="gt_row gt_center">L</td>
<td headers="team_short_display_name" class="gt_row gt_left">Nebraska</td>
<td headers="opponent_team_short_display_name" class="gt_row gt_left">Creighton</td></tr>
    <tr><td headers=".pred_W" class="gt_row gt_right">0.5532670</td>
<td headers=".pred_class" class="gt_row gt_center">W</td>
<td headers="team_result" class="gt_row gt_center">L</td>
<td headers="team_short_display_name" class="gt_row gt_left">Nebraska</td>
<td headers="opponent_team_short_display_name" class="gt_row gt_left">Minnesota</td></tr>
    <tr><td headers=".pred_W" class="gt_row gt_right">0.5048261</td>
<td headers=".pred_class" class="gt_row gt_center">W</td>
<td headers="team_result" class="gt_row gt_center">W</td>
<td headers="team_short_display_name" class="gt_row gt_left">Nebraska</td>
<td headers="opponent_team_short_display_name" class="gt_row gt_left">Michigan St</td></tr>
    <tr><td headers=".pred_W" class="gt_row gt_right">0.4923021</td>
<td headers=".pred_class" class="gt_row gt_center">L</td>
<td headers="team_result" class="gt_row gt_center">W</td>
<td headers="team_short_display_name" class="gt_row gt_left">Nebraska</td>
<td headers="opponent_team_short_display_name" class="gt_row gt_left">Kansas St</td></tr>
    <tr><td headers=".pred_W" class="gt_row gt_right">0.7902348</td>
<td headers=".pred_class" class="gt_row gt_center">W</td>
<td headers="team_result" class="gt_row gt_center">W</td>
<td headers="team_short_display_name" class="gt_row gt_left">Nebraska</td>
<td headers="opponent_team_short_display_name" class="gt_row gt_left">North Dakota</td></tr>
    <tr><td headers=".pred_W" class="gt_row gt_right">0.8884022</td>
<td headers=".pred_class" class="gt_row gt_center">W</td>
<td headers="team_result" class="gt_row gt_center">W</td>
<td headers="team_short_display_name" class="gt_row gt_left">Nebraska</td>
<td headers="opponent_team_short_display_name" class="gt_row gt_left">SC State</td></tr>
    <tr><td headers=".pred_W" class="gt_row gt_right">0.6874654</td>
<td headers=".pred_class" class="gt_row gt_center">W</td>
<td headers="team_result" class="gt_row gt_center">W</td>
<td headers="team_short_display_name" class="gt_row gt_left">Nebraska</td>
<td headers="opponent_team_short_display_name" class="gt_row gt_left">Indiana</td></tr>
    <tr><td headers=".pred_W" class="gt_row gt_right">0.5347438</td>
<td headers=".pred_class" class="gt_row gt_center">W</td>
<td headers="team_result" class="gt_row gt_center">L</td>
<td headers="team_short_display_name" class="gt_row gt_left">Nebraska</td>
<td headers="opponent_team_short_display_name" class="gt_row gt_left">Wisconsin</td></tr>
    <tr><td headers=".pred_W" class="gt_row gt_right">0.3225002</td>
<td headers=".pred_class" class="gt_row gt_center">L</td>
<td headers="team_result" class="gt_row gt_center">W</td>
<td headers="team_short_display_name" class="gt_row gt_left">Nebraska</td>
<td headers="opponent_team_short_display_name" class="gt_row gt_left">Purdue</td></tr>
    <tr><td headers=".pred_W" class="gt_row gt_right">0.5378156</td>
<td headers=".pred_class" class="gt_row gt_center">W</td>
<td headers="team_result" class="gt_row gt_center">L</td>
<td headers="team_short_display_name" class="gt_row gt_left">Nebraska</td>
<td headers="opponent_team_short_display_name" class="gt_row gt_left">Iowa</td></tr>
    <tr><td headers=".pred_W" class="gt_row gt_right">0.6559676</td>
<td headers=".pred_class" class="gt_row gt_center">W</td>
<td headers="team_result" class="gt_row gt_center">L</td>
<td headers="team_short_display_name" class="gt_row gt_left">Nebraska</td>
<td headers="opponent_team_short_display_name" class="gt_row gt_left">Rutgers</td></tr>
    <tr><td headers=".pred_W" class="gt_row gt_right">0.5043505</td>
<td headers=".pred_class" class="gt_row gt_center">W</td>
<td headers="team_result" class="gt_row gt_center">W</td>
<td headers="team_short_display_name" class="gt_row gt_left">Nebraska</td>
<td headers="opponent_team_short_display_name" class="gt_row gt_left">Northwestern</td></tr>
    <tr><td headers=".pred_W" class="gt_row gt_right">0.4308872</td>
<td headers=".pred_class" class="gt_row gt_center">L</td>
<td headers="team_result" class="gt_row gt_center">W</td>
<td headers="team_short_display_name" class="gt_row gt_left">Nebraska</td>
<td headers="opponent_team_short_display_name" class="gt_row gt_left">Ohio State</td></tr>
    <tr><td headers=".pred_W" class="gt_row gt_right">0.5590474</td>
<td headers=".pred_class" class="gt_row gt_center">W</td>
<td headers="team_result" class="gt_row gt_center">L</td>
<td headers="team_short_display_name" class="gt_row gt_left">Nebraska</td>
<td headers="opponent_team_short_display_name" class="gt_row gt_left">Maryland</td></tr>
    <tr><td headers=".pred_W" class="gt_row gt_right">0.4163104</td>
<td headers=".pred_class" class="gt_row gt_center">L</td>
<td headers="team_result" class="gt_row gt_center">W</td>
<td headers="team_short_display_name" class="gt_row gt_left">Nebraska</td>
<td headers="opponent_team_short_display_name" class="gt_row gt_left">Wisconsin</td></tr>
    <tr><td headers=".pred_W" class="gt_row gt_right">0.3430658</td>
<td headers=".pred_class" class="gt_row gt_center">L</td>
<td headers="team_result" class="gt_row gt_center">L</td>
<td headers="team_short_display_name" class="gt_row gt_left">Nebraska</td>
<td headers="opponent_team_short_display_name" class="gt_row gt_left">Illinois</td></tr>
    <tr><td headers=".pred_W" class="gt_row gt_right">0.4931497</td>
<td headers=".pred_class" class="gt_row gt_center">L</td>
<td headers="team_result" class="gt_row gt_center">L</td>
<td headers="team_short_display_name" class="gt_row gt_left">Nebraska</td>
<td headers="opponent_team_short_display_name" class="gt_row gt_left">Northwestern</td></tr>
    <tr><td headers=".pred_W" class="gt_row gt_right">0.6399772</td>
<td headers=".pred_class" class="gt_row gt_center">W</td>
<td headers="team_result" class="gt_row gt_center">W</td>
<td headers="team_short_display_name" class="gt_row gt_left">Nebraska</td>
<td headers="opponent_team_short_display_name" class="gt_row gt_left">Michigan</td></tr>
    <tr><td headers=".pred_W" class="gt_row gt_right">0.5899063</td>
<td headers=".pred_class" class="gt_row gt_center">W</td>
<td headers="team_result" class="gt_row gt_center">W</td>
<td headers="team_short_display_name" class="gt_row gt_left">Nebraska</td>
<td headers="opponent_team_short_display_name" class="gt_row gt_left">Penn State</td></tr>
    <tr><td headers=".pred_W" class="gt_row gt_right">0.6829783</td>
<td headers=".pred_class" class="gt_row gt_center">W</td>
<td headers="team_result" class="gt_row gt_center">W</td>
<td headers="team_short_display_name" class="gt_row gt_left">Nebraska</td>
<td headers="opponent_team_short_display_name" class="gt_row gt_left">Indiana</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p>By our cumulative metrics, are there any surprises? Should we have beaten Creighton or Purdue?</p>
<p>How could you improve this?</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./installations.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Installations</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./random-forest.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Decision trees and random forests</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>